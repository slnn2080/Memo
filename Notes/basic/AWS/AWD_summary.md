### 关系型数据库（RDBMS）
- MySQL、Oracle、DB2、SQL Server ……
- 关系数据库中全都是表


### 非关系型数据库
- 文档数据库MongoDB
- MongoDB的数据模型是面向文档的，所谓文档是一种类似于JSON的结构，简单理解MongoDB这个数据库中存的是各种各样的JSON。

- 那就意味着可以直接插入数组之类的复杂数据类型，并且文档的key和value不是固定的数据类型和大小，所以开发者在使用MongoDB时无须预定义关系型数据库中的”表”等数据库对象，设计数据库将变得非常方便

- 数据库  --  集合 --  文档

- 文档之间有3中关系
- 1. 一对一（one to one）:
<!-- 一个丈夫  对应  一个妻子 -->
<!-- 
  通过内嵌文档的形式来体现出
 -->

- 2. 一对多（one to Many）
- 父母 和 孩子		一个父母可以有多个孩子 但是1个孩子只能属于一个父母
- 用户 和 订单
- 文章 和 评论
<!-- 
  也可以用内嵌文档来映射一对多的关系 跟上面的一对一一样 只是把里面的属性变成数组了
 -->

- 3. 多对多（Many to Many）:
- 分类 和 商品 	一个分类里面能不能包含多个商品 比如厨具里面是不是有一堆 电饭锅 勺子 铲子
<!-- 
  多对多的话 我把 user_id 变成一个数组是不是就好了
 -->


### 日后的目标
- 我的理解可能不对, 但是确实是我通过这几个小时的学习得到的模糊性的观念
- 学习aws相当于需要细致的学习amazon在云端上给我们提供的各种服务
- 就像销售 要想卖出去东西, 首先要知道自家的产品, 何况可能还需要给客户解决问题 提供方案, 再看到有近200个服务 学习起来外加融会贯通是一个很漫长的过程

- 昨天给我最大的收获是 学aws今后的路线是什么


> solutions architect
- 方案架构师


### 总结来看Aws具体是什么
- Aws的全称 Amazon web Service
- amazon最开始是以电商出身, 大概在2006年的时候推出的专业云计算服务 以Web服务的形式向企业提供IT基础设施服务

- 目前已经是全球最全面, 应用最广泛的云平台, 从全球数据中心提供超过200多项的功能齐全的服务

- 数百万客户都在使用Aws来降低成本, 提高敏捷性
- AWS 现在于全球 24 个地理区域内运营着 77 个可用区


### AWS到底是什么
- 我们都说上云 云的概念说白了也就是运营着很多的数据机房, 对外提供出租, 我们租用它的性能, 租用它的计算能力 amazon在云上为客户提供了近200多种的服务

- 我们是远程登录到你的数据中心, 跳脱了硬件这一层, 硬件这一块全部的托管给它去做 我所做的事情 是我在上面创建虚拟机 运行我的服务 运行我的程序就可以 后端的所有硬件都交给亚马孙去维护 

- 也就是机房给我们提供的远程服务


### 云计算到底是什么?
- 跟我们传统的数据机房相对应的
- 一个叫做本地计算: 我的数据 我的计算 我的服务器 都是看的见摸得着的
- 一个叫做云计算: 我租用你的服务器 按照租用的时间和使用的量来进行付费 我对服务器本身不具备控制能力


### 云计算的优点
- 1. 敏捷性
  - 传统方式我们对基础设施进行架构的时候, 需要花费人力物力财力 最重要的是时间
  - 云计算我们不需要考虑上述的内容 我们只需要做在电脑前按几个下一步就结束了 给我们提供了很大的便捷性

- 2. 弹性
  - 我们可以在需要的时候通过aws帮助我们对服务器进行扩容, 在不需要的时候减少你的使用成本

- 3. 节省成本
  - 很弹性, 我需要多少台就付多少台的钱

- 4. 几分钟内进行安全部署


### 云计算的安全性和缺点
- 安全性实现的无缝加密
- 对成本的控制方面是比较艰难的地方, 云计算在使用的时候有很多隐藏的小开资


### 云计算类型
- 云公司根据不同的服务级别分为3种类型
- 包括:
- 1. 基础设施即服务
- 2. 平台即服务
- 3. 软件即服务

- 1. iaas 基础设施服务
- aws为你提供硬件 网络 计算 路由器等一系列的东西, 相当于给你提供了一个虚拟机的平台, 比如一个空的windows系统, 操作系统我们自己负责

- 2. paas 平台级服务
- IaaS是你安装你的操作系统 需要自己维护自己的操作系统
- PaaS是除了帮你把操作系统安装好之后还帮你去进行操作系统的维护和更新 外加你软件运行环境的运维
<!-- 
  而我们做的就是把写好的代码在平台上运行就可以了 我们用自己的软件 放入自己的工具
 -->

- 3. saas 软件级服务
- 全包了 软件都帮你开发好 你就直接用就可以



### AWS提供的核心服务
-  1. AWS的存储服务
-  2. AWS的计算服务
-  3. AWS的网络服务
-  4. AWS的数据库服务
-  5. AWS的容器服务
-  6. AWS的Devops服务
-  7. AWS的安全性、身份和合规性服务
-  8. AWS的管理和监管服务
-  9. AWS的成本管理服务
- 10. AWS的迁移服务
- 11. AWS的其他重要服务


>  1. AWS的存储服务
- Amazon S3 简单存储服务 simple storage service
- S3 它是以对象模式
- 常规的存储模式: 文件在系统看来是散装的, 如果有修改的话 是以打补丁的方式进行的
- 对象存储模式:   是以对象为单位, 修改都是对对象的重写

- s3里面会创建一个个的存储桶(相当于一个个的文件夹) 用来区分不同的资源
- s3中 数据以对象的形式存储在名为 存储桶 的资源中 单个对象大小的上限为5tb


- 生命周期:
- 在s3里面的文件 我们可以为它创建一个生命周期管理的策略 在到期的时候我们要怎么操作


> amazon s3存储类别 simple storage service
- 1. s3 标准
- 标准的模式 存储速度是比较好的
- s3的这种存储模式是高可用性的存储模式 我们把文件上传到s3 s3其实不是只有一份拷贝 它是在不同的可用区之间进行复制的

- 2. amazon s3标准 - 不经常访问(s3标准 - ia)
- 对于不经常访问的文件可以存储在那里, 因为使用的是不太好的磁盘, 所以存储费用会比较低

- 3. s3单区 - 不经常访问(s3单区 - ia)
- 我不需要放3个拷贝

- 4. amazon s3 glacier (s3 glacier)
- 它是使用过去最早的方式通过磁带来存储, 这种技术非常的成熟 价格也非常的便宜 会让成本进一步的降低

- 5. amazon s3 glacier deep archive(s3 glacier deep archive)
- 磁带都不在机器上转了, 深度归档的意思是 不再放在机器上等待别人的访问了

- 6. s3 智能分层
- 该模式下会根据读写访问数据进行分析, 从上到下的往下移

- 7. outposts
- 把托管的机柜没有放到amazon的数据中心而是放到你们公司的数据中心里面去了
- 既然是内网那即便是断网你的服务还是可以是继续的

- 总的来说 存储费用越往下越少, 但是检索费用却越来越高


> Amazon s3访问控制
- 由于它是基于云端的服务, 对于访问来讲是有一个严格的控制模式的 它是通过访问控制列表 和 存储桶的策略 进行控制的
<!-- 
  小区门岗
  楼内门岗
  单位前台
 -->

- 除了访问列表之外 还有一种基于策略的模式对访问的控制
- 一种是放在存储桶上的策略 另外一种是基于用户的策略

- 显性的拒绝大于一切, 隐性的拒绝大于隐性的允许
- 除非有显性的允许, 没有显性的拒绝 才有访问权


### Amazon Elastic File System   EFS(共享文件夹)
- 说白了就是一个共享文件夹
- 1. 静态加密
- 2. 动态加密


### Amazon Elastic Block Store   EBS()
- ebs是块状的存储 就是最传统的硬盘的存储方式
- 在虚拟机挂载磁盘的格式就叫做 ebs


> EBS的卷类型
- 1. SSD
- 2. HDD
<!-- 
  s3属于最好的那种也属于HDD 它的速度不快很慢 每秒大概在300md/s 它主打是做备份做文件存储
 -->

> EBS快照
- 快照是做备份使用的 比如我的系统 我要做一个快照 相当于将我们的磁盘整个读取下来放到了另外的一份拷贝里面去 这个拷贝可以在需要的时候恢复出来 , 通过这个快照再生成另外一台虚拟机

-----------------------------

### AWS的计算服务
- AWS最主要的是云计算的部分, 存储只是附带的

> 虚拟机的原理是什么?
- 我们正常的电脑在使用的时候 很少有情况能够把处理器用满 正常的使用率大概在20% - 70%之间 平均有50%的计算性能都是出于闲置的状态

- 将我们系统剩余的资源, 拿出来通过软件来管理从头到尾将它和你现有的系统进行一个逻辑上的切割 形成一个完整的计算单元 简称叫做虚拟机


### Amazon EC2  elastic compute cloud 
- EC2是一个标准的虚拟机 在linux上的一个虚拟机
- 安全且可调整大小的计算能力，支持几乎所有工作负载

- 它是一个iaas服务
- 它可以进入系统 可以安装自己想要的软件 可以修改里面的东西 


> EC2 实例类型
- 根据 cpu 内存 存储和网络容量(网卡的速度) 构成的一些选项
- 1. 通用计算类型
<!-- 
  普通内容搭配
 -->

- 2. 计算优化型
<!-- 
  处理器这块强一些 存储量大一些, 内存少一些
 -->

- 3. 内存优化型
<!-- 存储量大一些 -->

- 4. 加速计算
<!-- 可以选配显卡 来提供一些高速的运算 -->

- 5. 存储优化
<!-- 给一个高速的磁盘选项 -->

- 不同的计算类型 收取的费用也不一样 我们要根据实际的需求来进行选择
- 就好像是我们买电脑 选配机器一样


> 了解了cpu积分 突发性能实例
- 虚拟机也不可能是100%的负荷 当虚拟机处于30%的负荷的时候 有70%是空闲 这个空闲的部分可以变成cpu的积分 
- 空闲比例越长 积分就越高 积分是有一定的上限的 最高的累计数量是288个积分

- 但短时间出现满负荷的状态下还需要突破上限的情况下, 我们就可以消耗cpu积分来解决这个问题, cpu积分消耗没后 性能回复到100%
<!-- 
  10台虚拟机 能够承载1000万人, 但是11那天有1200万人

  其实这种突发性的性能增加是找别人借的 向那些空闲的人借的 aws会监控看谁的剩余资源比较多
 -->


> 多存储选项
- 1. 通用ssd
- 2. 预配置iops(ssd)
- 3. 磁性介质


> EBS优化
- ebs其实是跟虚拟机进行捆绑的 ebs是一种硬盘(从真实的硬盘中虚拟出硬盘来供你使用) 
- 在虚拟机的世界里也存在这些配置 我们使用最多的也是ssd 它们称为通用的ssd(简称gp2)
- 另外一种叫做iops(每秒读写的速度根据不同的速度还分为io1 io2)
- 最后一种就是hdd
<!-- 
  iops
  比如大型数据库要告诉读写的话 我们就必须使用iops(高性能的ssd) 不然的话客户读取会处于一个长期等待的状态

  磁性介质
  最大的优点就是便宜 适合做存储使用
 -->


> 置放群组
- 默认的情况下 我们是将虚拟机分开的 但是还是有需求让创建的虚拟机都在一起
<!-- 
  // 分开放的好处是
  不在同一个硬件服务器上的好处是之前我们了解的区域和可用区的概念, 当我们的数据放在多个可用区的时候 当有地震的时候 我们能确保我们的数据还是能用的
 -->

- 虚拟机分开可以在有意外的时候出现高可用性 但是增加了延迟性 因为所有的硬件不是在一台主机上 一定是通过网络跟另外一台虚拟机进行链接


- 1. 分步式
- 尽可能的将你的服务器打散放置在不同的硬件上
<!-- 
  将一小组实例严格放置在不同的基础硬件上以减少相关的故障
 -->

- 2. 集群
- 最大限度的将虚拟机全部放在一起
<!-- 
  将一个可用区中靠近的实例打包在一起, 通过使用该策略 工作负载可以实现所需的低延迟网络性能, 以满足HPC应用程序通常使用的紧密耦合的节点到节点通信的要求
 -->

- 3. 分区
<!-- 
  将实例分布在不同的逻辑分区上, 以便一个分区中的实例组不会与不同分区中的实例组使用相同的基础硬件, 该策略通常为大型分步式和重复的工作负载所使用
 -->


> 快照 snapshot
- 快照的作用主要是能够进行在线数据备份与恢复, 当存储设备发生应用故障或者文件损坏时, 可以进行快速的数据恢复, 将数据恢复到某个可用的时间点的状态

- 快照在aws中主要是用来做一个备份的使用 快照的本身就是将当前的磁盘 或者是系统盘+数据盘做一个完整的1:1的拷贝

- 快照在aws里面就是一个完整的拷贝 我们可以只拷贝数据盘 只拷贝系统盘 也可以全部拷贝 既然是一模一样那就意味着 可以通过快照创建一个跟虚拟机完全一样的副本

- 快照是纯粹的对磁盘进行复制
- 镜像是包括你的系统配置一起拉(连同虚拟机配置一起 快照只针对磁盘(数据))


> amazon ebs快速快照恢复(fsr)
- 快照保存下来是放在s3里面的 但是s3中的性能很低下, 快速快照恢复 不是将备份放在s3中 而是放在了另一块ebs 这个ebs使用的是ssd 这样响应的速度就快了



### AWS Lambda 
- 无需考虑服务器即可运行代码只需按使用的计算时间付费(秒)
- 只要拿着代码都可以在lambda上面直接运行 它是一种无服务器的模式 也就是说你不需要考虑服务器的存在

- 缺点:
- 1. 它有运行时间的限制 最大只能运行到15分钟默认的情况下
<!-- 
  内存是128 - 3008 以64mb为增量
 -->

- 2. lambda使用的资源是有限的 因为是无服务器的模式 不代表你可以使用无穷大的计算它是有限制的 你可以使用都大的内存去计算

- 解决方案:
- 我们可以把代码切分成好几个部分, 每一个部分在一个lambda中运行 根据第一个返回的值调用调用第二个lambda 第二个完事再调用第三个 ... 从而实现了打破了15分钟的限制


> AWS step functions
- 把整个步骤打散了并不是放到一起去执行(15分钟的限制), 现在可以打散了分步执行(分为多个lambda去运行) 

- 上面提到的可以将代码分几个部分放到不同的lambda中运行 这个就叫做 step functions

- 将我们的代码打散了 突破了15分钟的限制 但是因为内存3008mb有限制不适合大规模运算的 因为它没有足够的规模进行运算



### Amazon Lightsail
- 它是一个小型的虚拟机系统 它上面安装好了一些相关的小服务
- 可以创建一个小型的虚拟机给自己做网站的服务
<!-- 
  虚拟私人的小服务器 相当于配置好的ec2 只需要选择上面搭载的最终服务是什么
  它是一个小型的服务器 跟ec2类似比ec2简单很多 不需要考虑后面的数据库 网络存储等是什么 我们只需要选择数据库的大小  具体的数据库的类型不需要管
 -->



### AWS的网络服务
- 这节课里面额外需要看的知识点比较多 dns tcp ipv4 6等 还要抽时间去学习
> ipV4的地址
- 它是一个32位的地址 我们通过0和1进行表示, 每8位后面加一个. 翻译过来就是xxx.xxx.xxx.xxx

> ipv4中私有的ip地址有哪些? 有哪几个网段?
- 有3个
- 1. 10.0.0.0 -8
- 2. 172.16.0.0 -12
<!-- 
  -12 是从 172.16.0.0 - 172.31.255.255

  这些就是地址范围
  所以说为什么我们公司的地址会是以 
  172.16
  172.31
  192.168
  10.
  开头的

  是因为它们被保留下来作为私有的ip地址
 -->

> 子网掩码
- 它也是32位 前面多少位是用来表示网络段 后面多少位是表示地址段(还需要补足基础知识)



### Amazon Virtual Private Cloud    VPC
- 这节课里面还需要学 网络的相关知识 作为记录

- 这里讲的是一个虚拟网络的概念, 虚拟私有云
- 上面我学的存储服务类似于百度网盘 是一个对内对外提供服务的接口

> 虚拟网络
- 虚拟网络还在构建在物理网络之上的
- 虚拟网络是将物理网络多余的带宽 拿出来人为的划分出来 形成多个互相逻辑隔绝的小的局域网
<!-- 
  在网络世界里 比如我们的带宽是1000兆 我们网络上面所有的东西长期的跑在10兆左右 我们有990M的带宽都是空余的

  这种人为的划分我们可以理解成将物理的网络进行虚拟化 形成了一个虚拟的局域网
 -->

- 虚拟网络在亚马孙这就相当于把自己公司特别大的一个带宽拿出来分配 划分出来一个你可以使用的网络 这就是一个虚拟的局域网

- 这个虚拟的局域网 就叫做 Virtual Private Cloud 虚拟私有云

<!-- 
  VLAN:虚拟局域网

  VLAN就是虚拟局域网，是一组逻辑上的设备和用户，这些设备和用户并不受物理位置的限制，可以根据功能、部门及应用等因素将它们组织起来，相互之间的通信就好像它们在同一个网段中一样，由此得名虚拟局域网。
 -->

- 通过Vlan技术将物理网络进行一个分配 分割开来之后就变成了虚拟网络在云中它就是一个独立的网络 但实际上你的数据 和 别人在虚拟机上使用的数据 很可能都是跑在一条光纤上面的


- 都跑在一个跑到上就会涉及到安全的问题
> 虚拟网络上解决数据安全问题
- 1. 加密文件
- 2. vpn
- 3. 最好的方案就是 先建立vpn然后再对数据进行加密 因为还要防止内部数据被窥探
<!-- 
  vpn等于是我还在这条公路上, 但我是把这条车道修成了隧道 将车道完整的遮罩起来 别人都看不见

  vpn好处就是 加密的特别的好 坏处就是负载会大一些
-->


> internet 网关
- 在虚拟网络中 vpc可以理解为公司创建的小型的内网 内网可以在一个可用区也可以跨可用区, 同一个区域里面一个大的vpc里面可以包含多个数据中心

- 但是vpc虚拟网络是没有办法跨区的 这只是aws的限制 aws的vpc是在一个区域内创建的 每个区域内有自己的vpc 在默认的状态是可以创建5个vpc 这5个虚拟网络都是可以跨可用区的

- 在创建一个大的网络里面划分小的子网的时候 每个子网只能在一个可用区 但是vpc是可以跨可用区的

- vpc也是一样的 它也需要一个内部 和 外部 进行链接的一个东西 我们管这个东西叫做 internet网关(internet gateway)
- 一个vpc上有且只能有一个internet gateway 内外全都是通过这个网关对外进行交流
- 外面要是进来也是从这个网关走进来



> nat网关
- 网络地址转换
- net网关仅支持ipv4

- 作用:
- 公司外面打电话进来 拨到你公司的总计再转到你的分机号
- 内部电脑访问外部的地址 由于没有公网地址你是没办法直接对外访问的 我借用你的公司总机号再对外去打电话 在外部看来你用的都是公司的总号码


> Nat实例
- nat实例就是一个白盒 我们可以对它手动进行配置 由于它是一个实例 我们要自己负责配置 自己负责更新 因为是我们自己配置的 所以可能会出现太小的情况, 而nat网关是托管的服务 就不会出现太小等状况 来多少会自适应 nat网关来多少流量它都能帮你解决 按小时付费

- 实例是虚拟机 那nat实例就是nat虚拟机
- nat网关是一个托管的服务 我们没有办法对nat里面的具体转换进行配置 它是一个黑盒



### DNS
- 将ip地址 和 我们能够能记住的名称进行互相翻译的一个工具 对于aws来讲dns服务是一个非常正常的服务
<!-- 
  比如我们再ec2中去访问google.com 它首先会去找dns服务器去查询一下谷歌.com对应的ip地址是什么, 浏览器是通过ip地址去访问谷歌

  我们的浏览器都是用ip地址进行工作
 -->
- 我们可以使用aws内部自带的dns服务器 也可以使用自己的dns服务器



### vpc对等
- vpc对象就是拉网线 前提条件是确保两端的ip地址段不能重复 不然就没办法创建
- vpc的对象互联是不能传递的

<!-- 
  不能传递的解释
  就是说 a和 b 建立连接, a 和 c 建立连接 但是 b 和 c 是不能通过a去互相连接的
  也就是说 b 和 c 也要创建对等互联

  说白了就是要两两相连 相连的vpc才能建立连接
-->

> 路由表
- 路由表中包含一组被称为路由的规则, 用于确定来自您的子网或网关的网络流量的导向何处
- 类似gps

- 相当于一个十字路口 路口中间有一个向导 你问它如果要去日本怎么走 它会告诉你去日本走左边 去中国走右边


> 弹性ip地址
- 公有的ipv4的地址是有限的 假如我短期的需要一些公共的ipv4的地址 我可以向aws去申请一些短期使用的ipv4地址它可以给实例或其它的服务进行绑定 让你有一个固定ipv4地址 这个弹性的ip地址不用放在那是需要收费的 申请好了马上就用就不收费

- 一般对外提供服务的服务器如果有必要的话一般都会绑定一个弹性ip地址 让它对外提供服务


> 安全组
- 这个就相当于我们设置的门卫 控制流量 谁可以进来 谁可以出去 由安全组进行配置
- 安全组放在实例的虚拟机里规定什么样的流量可以进来 什么样的流量可以出去
- 也就是说每一个ec2都会配一个安全组(创建实例的时候有个选项就是配置安全组 规定哪一个端口是开放的)

- 它相当于套在虚拟机外面的一个门卫 其实实例的本身可以在操作系统里面再进行设置一个网络防火墙什么的, 但是现在是相当于在外面套一个门卫保证你的安全


> 网络acl
- 类似网络安全组的概念 它是放在子网的级别 放在更外面一层 放在网络这个级别 它可以控制所有子网下面的所有服务 包含ec2 包含其他的服务 只要是在这个子网里面的 就是由它控制的


> acl 和 安全组的区别
- 网络安全组默认是全部关闭的 只能一个一个去打开 打开需要的端口
- 在我们创建虚拟机的时候帮我们配置了网络安全组 我们要选择打开我们的3389号 或者是 22号端口 相当于在我们的虚拟机上面建了一道围墙 我们要开那个地方就在哪个地方开个洞

- acl不一样 它是默认全部允许, 门洞大开 在哪里需要隔绝的地方, 就那对应的地方建一堵墙


### Amazon Route 53 
- 它是一个dns服务 将ip地址和域名进行解析 它也有注册域名的功能


### Amazon CloudFront 
- 靠近用户端的缓存服务

- 比如日本公司创建了一个网站 美国想要访问这样一个带图片视频的网站 因为地理位置比较远延时比较长 资源图片 视频太大传输起来会发生卡顿

- 遇到上面的问题 我们可以在美国创建一个镜像


- 内容分发网络就是靠近客户端的一个缓存将静态的资源客户经常会访问的内容放到靠近客户端的缓存当中 
- 比如我们在国外访问淘宝并不会感觉很慢 一方面可能是淘宝在我们本地有服务器, 或者靠近我们的国家地区有缓存



### Elastic Load Balancing  弹性的负载均衡器
- 当我们在面对一个很大的数据访问量的时候 服务器的承载能力是有限的, 我们可以将这个巨型服务器打算了形成很多的小型服务器 在这些小型的服务器的前面 我们加上一个负载均衡器 它是将这些小型的服务器作为一个整体去处理 当前端收到流量的时候 通过哈希分配的方式分配到后面(平均分配 根据后端的承载能力 比如后面有10个服务器 1号服务器已经占了90%了 一般是从后端服务器池里面选择负载最小的那个去进行负载 它就相当于前端的前台)

- 1. Application Load Balancer
- 第7层的负载均衡器

- 2. 网络负载均衡器
- 第4层的负载均衡器

- 3. Classic Load Balancer
- 最老的一种 负载均衡器
<!-- 
  关键字
  ### OSI七层网络模型
 -->


- 负载均衡器分为几种类型
- OSI七层是将网络传输分成7层 比如我们发条微信都会过下这7层 一条数据的传输都是一个加包和解包的过程
<!-- 
  就好比每经过一层就套一层娃, 一共套7层, 发送到另外一台电脑后也需要解7层 

  第4层是:
  比如我收到了一封信 我拆开了包装里面还有一层信封 信封上已经写明了这个信是谁发过来的 发到哪个部门的 要求对方是干什么的 这个就是第4层 但是信件还没有完全拆开


  第7层负载均衡器
  - 这个是指 我们将数据包已经解压到最后了 一发过来的信我们已经全部拆开 我已经能看到你的信件正文了 我看完之后再决定发给谁 这就是第7层 


  到这一层我们的信件已经完全展开了 就意味着我们可以根据你的消息进行更高级的过滤的 因为我已经能看到里面的内容了 比如第4层负载均衡器收到的是一个信封 然后我把信封交给它的主人 这事就完了 至于信封里面是什么东西我就不管了

  到了第7层的负载均衡器已经把信件拆开并且看了一遍 它再决定这封信应该不应该发给它的主人

  所以到了第7层我们就可以加一个防火墙 第4层是没办法安装防火墙的 因为看不出来里面有什么

  网络应用程序防火墙只能工作在第7层 是因为只能在解包完成之后 我们才知道里面有什么 我们才能决定要不要过滤
 -->


- 负载均衡器 可以 对外 和 对内 使用
- 在工作中我们对外的服务使用的是  大部分对外都是通过网页的形式展示的 所以我们使用 第7层的负载均衡器 比较安全(有的公司如果只提供ftp传输的话 很可能会用第4层 场景很少)

- 对于公司内部的话 我们没有安全上的要求 更多的是速度的要求 我们在内部只需要使用网络负载均衡器就可以了



### 证书管理 AWS Certificate Manager
- 证书是包含密钥的东西
- 密码: 这个就是我们平时输入的密码

- 密钥: 就是之前间谍使用的密码本
- 目的: 你监听到的消息是你看不懂的
<!-- 
  明文传输:  a 发送 '你好' 给b      假如有监听器的话 别人就会直接获取消息

  为了解决上面安全的问题, 我们可以将内容进行加密
  假如a 和 b 使用的是同一个密码本 进行加密 和 解密的话 叫做 对称性加密
  将明文加密成别人看不懂的密文 假如监听者没有我们的密钥是没办法对密文进行翻译的
  
  - 对称性加密
  - 双方使用的是同一个密码本(同一个密钥)
  - 好处: 由于双方使用的是同一个密钥 翻译的速度比较快
  - 缺点: 双方有一方丢失了密钥 通讯链就断掉了


  为了改掉丢了密码本全部人都要暴露的这种问题 我们改为非对称型加密

  - 非对称型加密
  - 我拥有一个密码本 你拥有另外一个密码本 我通过我的密码本翻译的东西只有通过你的密码本才能解密 我自己都没有办法解密(加密之后没有办法解密的) 这就是非对称性加密

  - 非对成型加密的密钥一般分为 公有的密钥和私有的密钥
  - 公有密钥是每一个人都可以发的
  - 私有密钥只有自己才能拥有的 

  - 公有密钥和私有密钥是一一配对的 一把公钥配一把私钥
  - 好处: 丢了一把钥匙不至于将整个数据链全部丢失 最重要的是保留私钥
 -->

> 证书:
- 验证身份的
- 就是证明你是你 或者是 他是他 是用来验证你的身份是否是你自己
- 有两种验证方式
- 1. 私有证书(不被大家公认的整数称之为私有证书) 非公认的颁发机构发的 私有证书是不被信任的
- 2. 公有证书(还有就是我到公证处和派出所这个是大家公认的)

- 我们在访问一个网站的时候 会先去访问这个网站的证书 拿到证书后的第一件事就是验证这个证书的真伪 然后得到确认后 我们再使用证书上的公钥 去传输信息
<!-- 
  我们在传输消息之前肯定是验证证书的证明它是它
 -->


### Amazon Relational Database Service (RDS)
- AWS为我们提供了 关系型数据库的服务

<!-- 
  关系型数据的概念

  我们整个表格要先定义好 字段 或者是框架 然后再往里面放入数据 我们有很多预先定义的不同的表格 表格和表格之间是通过一些关键词进行链接 

  比如两个表格都是以学号作为主序列那么这两张表格就可以合并成一个表格(视图) 方便我们进行检索

  关系型数据库对应的另一面叫做非关系型数据库 关系型数据库的列是预先定义好的 一般来说是不会做任何修改的, 如果对于框架来修改的话 会修改整个的表格 比较麻烦

  非关系型数据库 它对架构的定义是很松散的 我们可以随时进行修改 对于行里面的内容来说 不要求列里面要对应有数据

  关系型数据库来说一定定义好了一列 那么这列里面就要有相应的数据 哪怕是一个空值也要必须有 关系型数据库是一种比较严格切规范的数据库模型 是一个完整的列表


  关系型数据库非常适合什么场景?
  关系型数据库是结构非常严格已经规定死了的数据存储模式 比如像银行 它对数据库要求的就非常的严格 非常的完备 一般情况下除非重大的事故 是不会做任何的更改

  想如今的互联网模式的话 我们可以输入任何的信息 这种情况就非常的适合用非关系型数据库 因为它很难去定义整个表格的数据 或者说没有办法定义 所以我们的内容肯定是经常要被修改的 所以适合菲关系数据库

  比如我今天跟大家聊天 我定义好了名字 发言 发言的话肯定不是一个简单的数据 它是一个单独的文件格式 是一个json的格式

  但是对于关系型数据库来说 我定义好了一个名字 那么我去查询的时候一定可以在响应的地方查到响应的数据 而不会去做额外的工作
 -->

- 亚马孙给我们提供了5中数据库, 它的兼容模式是这样的, 它的后台是亚马孙给我们创建了一个虚拟机或者说是多个实例 来帮助我们做一些底层的工作 我们所需要做的就是 对这些实例上面的软件进行使用

- 这种模式是哪一种的虚拟化的模式呢? saas模式 硬件 软件 都帮我们配置好了 我们所做的就是使用这个软件就可以了 所以是saas服务

> aurora 是amazon自家的数据库
- 是魔改的mysql 它不是一个全新的数据库 它是集成mysql和postgreSQL的优点的一个数据库 aurora并不是一个单独的服务而是放在redis里面


> Amazon RDS 多可用区的部署
- RDS是一个托管服务 它可以利用到Amazon多可用区优点 可是实现多可用区的部署 我们可以除了主数据库之外 还可以创建其它的副本

- 副本分为两种, 主要作用就是在我的主服务器发生问题的时候 我们的副本可以通过人为的提升, 将它提升为一个主服务器
- 1. 待机副本
- 2. 只读副本

- 一般我们在正常的区域里面都是2-3个可用区 可以在当前的可用区里面创建一个只读副本 也可以创建多个

- Mysql也分为两种 一种是读写, 一种是只读
<!-- 
  mysql在创建的时候能创建一个副本 如果数据库崩溃了 我们还可以利用到副本

  如果建立一个数据库出现问题是怎么处理的?
  Mysql也分为两种类型 一种是只读 一种主数据库 主数据库可以进行读写 数据库大部分的内容都是从中读取那我们又要负责读 又要负责写 那么我们的i/o就会出现一些问题 我们就要取舍i/o到底是要用来读还是写

  一般来说我们创建数据库都是这样的 我们会创建一个主数据库 再创建一到多个只读数据库 他们之间的关系是 非同步的模式

  主数据进行更新之后 它会慢慢的更新到只读数据库里 只读数据库顾名思义 就是 对外提供读取的

  这样讲主数据库主要承担的功能 从可读可写 慢慢过渡到 专门用来写 读取的话会放到只读副本上面 

  当我们的主数据出现问题的时候 我们可以手动的提升其中一个的只读副本(用户最新数据的) 来作为一个主数据库 是这种提高高可用性的模式
 -->


- RDS的多可用区部署的待机副本(待机数据库)
- 我对你这个数据库创建一台完整的一模一样的数据库 但是这个数据库创建好是不可见的隐藏的状态 当我们的主数据出现问题的时候 系统会自动切换到待机数据库上面去 这种叫待机模式
<!-- 
  待机的数据库不管用不用我们要付钱
 -->

- RDS的多可用区部署的只读副本(只读数据库)
- 一个主数据库 外加 一到多个只读副本, 只读副本和主数据库是非同步 也就是说主数据库里面的数据更新会立马发送到只读副本中 它会按照它的等待时间(5-15分钟)同步一次 将新的数据同步到只读副本中 

- 所有其他的用户 对数据库进行数据读取的时候 都会优先发送到只读副本 主数据库是用来写入


- 那我们是怎么判断使用哪一个数据库呢(一个主四个副选择哪个?)
- 我们是使用负载均衡器 它的对外接口就是两个一个读一个写 写的接口指向了主数据库的, 读的接口指向了负载均衡器 由它指向后端的服务器

- 我们在创建RDS的时候对外读写都是一个接口
- 对外提供的接口是一个什么样的格式? ip地址还是dns
- 一定是dns 因为后端的数据库可能随时会变 比如提升了 或者 删除掉了 那我的ip地址会随时发生变化 只有dns地址是不会变的

- 待机副本可以给主数据库 和 只读数据库都可以创建
- 我们创建的待机副本 待机副本不工作 没有任何的事 待机副本 和 数据库之间是实时的同步复制, 主数据库发生更新不可见的待机副本也会马上更新(这点和只读副本的更新方式不一样, 只读副本是非同步的更新)


> Amazon Aurora
- Aurora是一种与Mysql和PostgreSql兼容的关系数据库
- 它一个魔改的Mysql和PostgreSql aurora在前两者之上提高了性能 它帮我们预先配置好了主数据库 只读副本(创建aurora的时候都帮我们创建好了)
<!-- 
  比如我要是在日本创建了一个aurora 它就会帮我在日本的可用区至少创建一份可读副本(3个可用区至少有2个) 数据盘在每个可用区自动有两个备份

  也就是说一个主数据库 两个只读副本 6份数据 主要我们创建了一个aurora

  当然不是只能创建两个只读副本 我们支持最多创建15个只读副本(3个可用区里面)
  数据盘在每个可用区最少有两套
 -->

- aurora就是一个预先配置好的mysql 就部署来说它是一个非常自动化的过程
- aurora帮你预配好了这么多的事情, 安全性可调校到最高了 它的代价就是贵 非常的贵



> 非关系型数据库 Amazon DynamoDB
- 非关系型数据库就是说 架构没有办法满足我们的所有要求 也就是说我们没有办法在创建数据库的时候把所有的请款古兜考虑到 尽善尽美(初始化定义的时候就将表格定义的非常完美 把所有的情况都包含在内), 那怎么办?

- 我们就使用这种非关系型数据库 它的结构是不固定的不稳定的 它的架构是可以随时的进行更改的 这种的好处就是尽可能的满足你所有的需求 还可以储存几乎所有的数据类型 和 所有的情况 哪怕当前的表格 我没有针对当前的情况设置对应的列 但是由于我是非关系型的数据库 所以我的结构可以马上进行更改 添加响应的列 或者说我们文档之类的其它方式进行描述 而不是将数据直接存到表格里面来

- 非关系型数据库也是支持关系型数据库的表格, 只是关系型数据库的表格是不能简单的进行修改 
- 那么非关系型的数据库定义好的表格不改就是了 还是可以用非关系型的数据库当关系型的数据库进行处理 


- 非关系型数据库对处理的优化 和 关系型数据库是不一样的
<!-- 
  ppt文档中说 dynamoDB每天可处理超过10亿请求, 并可支持每秒超2000万个请求的峰值
 -->

- 我们思考一下 对于关系型数据库 和 非关系型数据库 哪个处理数据 请求比较快
- 没有说它俩谁更快一些
- 非关系型数据库并不是只有kv这一种模式 还有文档的模式 还有图形处理的模式
<!-- 
  假设双方都只有一个表格 那查询起来的话一定是关系型数据库更快 但是关系型数据库往往不只有一个表格

  我们可能通过一个查询去链接一个表格 再去链接另外一个表格 当它牵扯的表格越来越多的时候速度就会越来越慢

  这就是很多新的互联网公司将它们的数据库 慢慢的从关系型 迁到非关系型

  就处理数据的速度而言就关系型更快 但是由于它的结构复杂 导致它的能效比非常的底下 就现在的复杂的场景来说

  非关系型数据库 由于它的非常简便 所有表格都是一个索引 一个表格几乎可以放下所有的数据 即便整体效率不如关系型数据库

  关系型数据库比如说 只要确定好了数据 确定好了好查询的内容 你的返回来的值就一定再那个位置 可以很方便的去定位 导致数据块

  对于非关系型数据库来说 由于你是键值对的 或者说是文档的模式 键值对的方式比较快一些 但是文档来说 比如前面是学号 我后面对应的值 不是一个具体的数字 而是一个json的文件

  对于数据越大 越复杂 非关系型的数据库就越快 结构越简单 关系型就越快
 -->

- 如果我们的数据是kvkv的 关系型会快一些 但是数据不可能只有一个表, 所以非关系型数据库, DynamoDB是非常适合现状的

- 网游的数据库 国内很多用的是MongDB 它非常适合我们互联网企业 用户很多

- DynamoDB也可以作为缓存来使用
- 类似 移动 web 游戏 广告技术, 物联网 以及其他需要任何规模的低延迟数据访问的应用程序 都会选择非关系型数据库 因为这些企业的数据可能是灵活多变的结构


> Amazon ElasticCache
- 我们在前端的服务器处理完数据的时候会不断的对后端的数据库发起请求去查询相应的数据或者说写入相应的数据
- 但是由于数据库里面的数据是放在硬盘上的SSD HHD我们的处理数据会遇到瓶颈 就算是6万4千次的SSD 我们假设前端有100台的数据服务器 同时对后端的数据进行查询 天猫11 每秒有上亿的请求向后端进行查询 那我们的数据库就会承受上亿次的查询 那我的硬盘的承载能力是64000次 那该怎么办? 我该怎么提高数据库的性能

- 将最近用的内容放到缓存里面去
- 缓存存放数据的地方不再是硬盘而是内存 我们创建一个缓存其实它也是一台虚拟机 它的特色就是它的处理器不需要很大 硬盘也不需要很大 它唯一需要大的就是它的内存 我们可以设置一个双核的cpu 加上1280G的内存 这是一个标准的缓存服务器

- 由于内存的速度会比硬盘的速度快上上千倍 所有的数据第一次查询的时候会优先的到缓存里面去去检查一下看看之前有没有人查询过 有没有对应的结果 如果没有我就去硬盘里面读取结果 第一次会比较慢 第一个用户接到数据后 还会在缓存中放一份存档 第二个用户再次请求该数据的时候就会去缓存里面查找 看看有没有对应的结果 有就会从缓存汇总直接给用户 用于内存的速度会比硬盘的速度快1000倍 这样做极大的缓解了对数据库的压力 这是借助了速度差

- 那么问题来了 缓存也不是无限大的 因为大家不会只查询同一个页面 比如双11 那么缓存中就会积攒上千万的页面 最后就会存满

- 当缓存存满的时候 怎么处理呢 它借用了冒泡算法 我的数据放了一份在缓存里面之后 数据本身就会被加上一个标签 这个标签上会有对应的数字 有多少人读取了这个缓存的数据 每隔一段时间就会根据这个数据进行从高到低的排序 排在最后的进行删除 更新缓存 将访问量低的从缓存中删掉空出新的位置来

- amazon还给我们提供了另外一个服务 是队列服务
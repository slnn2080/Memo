
### solutions architect 
- 方案架构师
- 云架构师是负责云技术所有细节的专业人员，从计算策略到采用计划，从云应用设计到部署，管理，监控以及其他云基础架构详细信息。这些是采用并愿意实施云解决方案的每个企业所需的最重要方面。一名云架构师的年收入超过10万美元。

### developer
- 开发者
- 成为一名云软件工程师，需要了解各种编程语言。因为需要使用这些能力在AWS平台上设计软件。此外，需要维护基于云的系统/软件的开发并确保其正常工作。云软件工程师在美国的年收入高达12万美元。

### sysops administrator
- sysops管理员
- 系统运维管理员负责处理企业中云系统整个生命周期。他们的工作包括在AWS云平台上进行管理，部署和操作。AWS系统运维管理员的年薪为13万美元。

---

### AWS区域的全球网络
- AWS就是靠网络存储起家的 2016年开始 云计算之前, 我们每个公司都有自己的服务器 有自己的数据中心 运维服务器是需要人力财力
- 最早的虚拟化, 比如我们买了一台顶配的电脑去扫雷, 闲置了99%的资源, 那我把这99%的资源出租出去

- 所谓的虚拟化也是构建在物理的硬件的结构上 我们设置一个数据中心前后大约要半年的时间

- 全球最流行的知识, AWS(Amazon Web services) 是全球最全面, 应用最广泛的云平台, 从全球数据中心提供超过175项的功能齐全的服务
- 数百万客户(包括增长最快度的初创公司, 最大型企业和主要的政府机构)都在使用Aws来降低成本, 提高敏捷性并加速创新

- 所谓的云服务 并不是把服务器放在云上面, 而是将服务器作为一个服务(比如很多的公司自己搭建的数据中心将自己的服务器作为服务放在云端, 对客户提供这些服务), 服务器并不在本地不受自己操控的 这种计算模式称之为云计算, 简而言之 使用别人的服务为自己来进行计算

- 市面是最有名的公司 亚马孙 微软 谷歌 最有名的aws
- AWS 拥有最广泛的全球云基础设施。没有其他任何云服务提供商 能够与我们一样，提供如此多通过低延迟、高吞吐量和高冗余度的网络连接的具有多个可用区的区域。

- AWS 现在于全球 24 个地理区域内运营着 77 个可用区，并宣布计划在印度尼西亚、日本和西班牙新增三个 AWS 区域，同时再增加 9 个可用区。
- Gartner 已将 AWS 区域/可用区模式视为运行需要高可用性的企业应用程序的一种推荐方法

---

- amazon将对自己的服务划分为两种类型 一种叫做区域 一种叫做可用区域

> 区域:
  是按照地理位置来分的 比如 日本就是一个大区, 而一个区域里面有2-3个可用区

> 可用区:
  可以理解为他们的数据机房(比如日本的东北地区有一个机房里面有很多的服务器)
  可以让我们来选择并且使用的数据所存放的地方


- 云的概念也是运营着很多的数据机房, 对外提供提供出租, 我们租用它的性能, 租用它的计算能力 但是这个租用的概念跟我们以前了解的租用不一样, 我们并不是租用它的硬件服务器, 而是租用里面的计算能力
- 我们是远程登录到你的数据中心, 租用它的计算能力比如虚拟机 服务等 跳脱了硬件这一层, 硬件这一块全部的托管给它去做 我所做的事情 是我在上面创建虚拟机 运行我的服务 运行我的程序就可以 后端的所有硬件都交给亚马孙去维护 

---

### 云计算
- 跟我们传统的数据机房相对应的
- 一个叫做本地计算: 
  的数据 我的计算 我的服务器 都是看的见摸得着的

- 一个叫做云计算: 
  我租用你的服务器 按照租用的时间和使用的量来进行付费 我对服务器本身不具备控制能力

- 云计算通过互联网按需提供 IT 资源，并且采用按使用量付费的定价方式。您可以根据需要从诸如 Amazon Web Services (AWS) 之类的云提供商那里获得技术服务，例如计算能力、存储和数据库，而无需购买、拥有和维护物理数据中心及服务器。


- aws的服务器是按秒收费的 云计算的技术算是一个虚拟的技术, 加上全球化的整合
- 亚马孙本身是电商, 它有很多的服务器为自己提供服务 它当初发现它的服务器长期的使用率不是很高 它就不多余的能力分出来对外提供计算能力的出租
- 云计算再说白一点就是机房给我们提供远程的服务


> 云计算的优点
- 1. 敏捷性
<!-- 
  对我们基础设施进行架构的时候 会非常的容易
  比如传统的方式 我们搭建一个机房 我们
  首先  要选择一个物理位置比如选择一个仓库 一层楼 一个机房
  然后  跟硬件提供商购买硬件 还要购买响应的网络设施 还要招聘一系列的运维人员
  然后  这些都搭建好后 我们还要搭建软件平台
  然后  交由软件工程师们在软件平台上运行软件并测试

  一整套下来 我们消耗的人力物力财力且不算 我们花掉了很多的时间(半年时间)

  而云计算我们不需要考虑上述的内容 我们只需要做在电脑前按几个下一步就结束了
  给我们提供了很大的便捷性
 -->


- 2. 弹性
<!-- 
  比如天猫双11的时候 它的访问量达到了5-10倍 假如天猫有1000台服务器, 每秒能承载1000万的访问量 在双11的时候 每秒可能有上10亿人次的去访问
  那么双11 按照常规的理解我需要对我们的服务器进行扩容, 传统的方式还是跟上面的步骤一样 确认场地购买硬件等
  在云时代 在你需要的时候迅速的帮你扩充容量, 在你不需要的时候减少的你的使用成本, 遇到这种突发的情况, 我们指需要付出在那个时间段对应的成本即可而不需要付出长期的投入
 -->


- 3. 节省成本
<!-- 
  由于我们有了弹性 整个的成本控制就变的十分的精细化 我需要10台就付10台的钱, 不需要的时候立马就可以降下来
  通过敏捷性和弹性达到控制成本的问题
 -->

- 4. 在几分钟内进行全局部署


> 云计算的安全性
- 安全性实现的无缝加密
- 存在上面的数据都是可以加密的(密钥可以它控制 也可以你控制) 这点是可控的
- 数据存储放在本地, 计算方面交给云计算


> 云计算主要的缺点
- 对成本的控制方面是比较艰难的地方, 云计算在使用的时候有很多隐藏的小开资
<!-- 
  传统的方式我们进行数据传说 只需要付贷款的租用费用
  但是我们把数据传到云上, 下载下来是需要按照流量额外付费的
 -->

- 云上两个虚拟网络之间需要传输也是需要费用的
- 一个可用区域内 内部传输是免费的, 但是两个可用区之间 或者 跨区域之间传输是额外收费的 其它还有需要相互之间传输是需要收费的

- 传统的上的方式 所有的花销是可预期的
- 但是对于上云的企业来讲 未来的成本预期是比较困难的事情

<!-- 
  由云诞生的两大职业
  1. 运维开发
  基于云计算的开发 上云之后 后端的运维很多是云公司替我们做了

  2. 财务优化
  由于云的成本控制特别困难还诞生了另外的一个职业  云的财务优化变成一个单独的行业了

  3. 安全运维
  由于所有的东西都是放在网络上的 安全性就变的非常的重要 基于云安全的职业
  云计算它的出现消灭了运维 在云的时代我们不需要运维了


  对运维职业的影响:
  运维职业是对硬件和软件进行维护, 但是在云的时代 后面的硬件都托管给云公司了不需要你进行维护了, 软件维护方面一般软件开发的人就可以进行维护了

  daiwosi
  一般我们开发完会将代码上传到git 之后我们就可以不管了交给后面的测试的人
  测试的人将代码提取出来发送到测试环境 测试完生成一个结果 回馈给我们

  最后交给运维 运维会做一个商业环境会进行一个生成 确保我们的代码在商业环境中运行

  daiwosi这个职业就是将开发 测试 运维的步骤一个人做了因为借助云计算我不再需要后台别人帮我进行管理维护 我只需要做的是我作为一个开发写好的代码之后交给后面自动化的一个部署测试 测试完之后我们进行生产话 整个环节只需要一个人就可以了

  对运维来讲 生成环境 测试环境 最后对环境的维护也不需要你 运维还能干什么呢?
 -->

---

### 云计算类型
- 云公司根据不同的服务级别分为3种类型

- 包括:
- 1. 基础设施级服务
- 2. 平台级服务
- 3. 软件级服务

- 每种类型的云计算都提供不同级别的控制、灵活性和管理，因此您可以根据需要选择正确的服务集。


> 基础设施级服务 (IaaS)
- 它帮你提供硬件 包括背后的网络 计算 路由器 等于它给你提供了一个虚拟机的平台 创建一个虚拟机 
- 比如一个空的windows系统, 操作系统我们自己负责, aws确保我们的硬件 并且利用它背后的硬件来进行运算 我们所能掌控的就是操作系统网上里面的系统 里面的软件 里面的运行环境 跟服务器一样你只管用就可以了
<!-- 
  IaaS 包含云 IT 的基本构建块。
  它通常提供对网络功能、计算机（虚拟或专用硬件）和数据存储空间的访问。IaaS 为您提供最高级别的灵活性，并使您可以对 IT 资源进行管理控制。它与许多 IT 部门和开发人员熟悉的现有 IT 资源最为相似。
 -->

>>> 例如: ECTO

---

> 平台级服务 (PaaS)
- IaaS是你安装你的操作系统 但是aws就不管了 你需要自己维护自己的操作系统
- PaaS是除了帮你把操作系统安装好之后还帮你去进行操作系统的维护和更新 外加你软件运行环境的运维

- 而我们做的就是把写好的代码在平台上运行就可以了
- 帮你提供硬件和操作系统之外, 还帮你提供了 你的软件和生产环境需要的一些运行环境 我们所要做的就是将我们的网站复制到这个平台上面去 就直接运行起来了, 我们只考虑我们的网站怎么去设计 怎么写的 后面的情况就不需要去关心了 我们用自己的软件 放入自己的工具
<!-- 
  PaaS 让您无需管理底层基础设施（一般是硬件和操作系统），从而可以将更多精力放在应用程序的 部署和管理上面。这有助于提高效率，因为您不用操心资源购置、容量规划、软件维护、补丁安装 或与应用程序运行有关的任何无差别的繁重工作。
 -->


> 软件级服务 (SaaS)
- 全包了
- 软件都帮你开发好 你就直接用就可以
<!-- 
  SaaS 提供了一种完善的产品，其运行和管理皆由服务提供商负责。在大多数情况下，人们所说的 SaaS 指的是最终用户应用程序（如基于 Web 的电子邮件）。使用 SaaS 产品，您无需考虑如何维护服务或管理基础设施。您只需要考虑如何使用该特定软件 
-->
>>> 例如: outlook 微信 qq 页游

---

### AWS的核心服务
- AWS 成本管理，业务应用程序，计算，容器，数据库，开发人员工具，物联网，机器学习，管理与监管，媒体服务，迁移与传输，移动，联网和内容分发，量子技术，机器人技术，卫星，安全性、身份与合规性，存储
- 超过了200种服务


- 以下是aws中我们要重点学习的内容

---

### AWS的存储服务

> Amazon S3 
- 专为从任意位置存储和检索任意数量的数据而构建的对象存储
<!-- 
  亚马孙提供的最早的服务 2006年提供的 类似百度网盘
  这是一个非常简单的云端存储 唯一跟百度网盘不一样的地方 就是基于对象存储
 -->


> Amazon Elastic File System 
- 可扩展的、弹性原生云 NFS 文件系统
<!-- 
  NFS 文件系统 文件共享 共享文件夹就是一个nfs
  ams在云上设置好了一个共享文件夹, 别人可以通过链接地址在本地使用这个共享的文件夹
 -->


> Amazon Elastic Block Store 
- 易于使用、适用于任何规模的高性能数据块存储
<!-- 
  虚拟机上的一块硬盘 硬盘又分好多种类型 我挂载到我的系统上 决定大小和速度 付的钱多那性能就是好的
 -->


> AWS Storage Gateway 
- 对几乎无限的云存储的本地访问权限
<!-- 
  在本地设置一个缓存, 通过这个缓存(其实就是代理) 通过这个代理将本地存储和云存储之间进行同步
  当创建这个代理的时候相当于设置了虚拟机 然后里面放了一个文件缓存的地方 不管是上传到云还是下载 先放到缓存这里 这个缓存会在本地映射一个盘符 可以直接进行访问
  算是一个中介
 -->


> AWS Snow 系列 
- 高度安全且便携的设备收集和处理边缘位置的数据，并将数据迁移到或迁移出 AWS
<!-- 
  大号的U盘 40-60tb 一个真实的设备 还有更大的硬盘卡车 将数据进行迁移或迁移出

  1000兆 上传100tb的东西要9天 那假如我们要3天迁移完毕怎么办
  100TB = 100 X 1024G X 1024M / 125
 -->

比如在柜子里把照相机拿过来 这时候我们文字字符串的形式没办法锁定一个物件
计算机里面也是 比如有个空间我们要存储一个数据 比如当前的资料 用户的购物车数据

可能要把用户的权限的信息也放在这里面 只要我去这个容器里面找 就能找到这个数据
如果我们往这个空间放数据的时候 起字符串的格式 apple 可能会有重名的问题 后面的会覆盖掉前面的 我们会加前缀 组件也是 为了区别我们要使用字符串
让一个值永远是唯一的

- 上云服务最主要的就是能解决成本 再加上它的灵活性 弹性

---

### AWS的计算服务
- AWS最主要的是云计算的部分, 存储只是附带的
- 我们使用的本地虚拟机都有什么? 

> Amazon EC2 
- 安全且可调整大小的计算能力，支持几乎所有工作负载
<!-- 
  好比租用 租多久付多就的钱

  paas定义 帮你装好了操作系统 和 软件的运行环境 直接上传和写入代码即可 操作系统和软件的运行环境都是托管的看不到的 你也管不到
  EC2是一个虚拟机 你可以进入系统 你可以安装自己想要的软件 你可以修改里面的东西 它一定是iaas 不是paas因为paas是没有办法进入操作系统的
 -->


> AWS Elastic Beanstalk 
- 简单易行，无限扩展
<!-- 
  基于EC2 帮助我们把平台都安装好了 直接使用就可以了 paas服务
  操作系统 和 软件的运行环境都是准备好的 你所要做的就是把你的代码上传上去

  它是标准的paas服务 你对服务器并没有太多的控制权
 -->


> AWS Lambda 
- 无需考虑服务器即可运行代码只需按使用的计算时间付费(秒)
<!-- 
  按照运行的次数和时间来进行付费 跟我们打电话很像 按时间次数收费 游戏厅投币的感觉

  上面接触到iaas paas saas有一个共同的特点就是必须知道后台服务器的大小 大小就是说服务器的配置

  适合短期运算 和 非常规运算适合这种模式 我们使用无服务器的模式 优势更加的节约成本

  它每次运算最多15分钟 它适合短期的运算

  适合的场景: 公司报表一年一次, 

  银行的按揭查询就是无服务器的计算
 -->


> Amazon Lightsail 
- 以可预测的低廉价格获得虚拟服务器、存储、数据库和网络
<!-- 
  虚拟私人的小服务器 相当于配置好的ec2 只需要选择上面搭载的最终服务是什么
  它是一个小型的服务器 跟ec2类似比ec2简单很多 不需要考虑后面的数据库 网络存储等是什么 我们只需要选择数据库的大小  具体的数据库的类型不需要管
  比如我们创建好了一个小型服务器 把我们写好的网站直接丢在上面就可以了
 -->


> AWS Outposts 
- 运行本地 AWS 基础设施和服务以获得真正一致的混合体验
<!-- 
  亚马逊在你公司的本地放一个机柜 放上他们托管的服务器 这个服务器本身是放在你办公的地点 通过专线或者vpn跟亚马孙直接去链接

  我们好不容易上云, 亚马孙又把一部分的服务器放在我们本地的机房 为什么?
  安全 速度快 独享设备

  虽然亚马孙把服务器放到了本地, 但是我们对这台服务器没有拥有权 服务器还是由亚马逊来管 它的好处是在数据传输不用通过网络上传到云上 你的数据是跟本地进行交流 一是速度快 二是安全

  设备独享
  云上有很多的虚拟机, 但是这些虚拟机 并不是你自己独享的

  这些服务器放在你们公司 虽然你不能碰 但是我能确保这些服务器是你们公司独享的
 -->

- 有些数据比较敏感的不需要去上云 我们本地的自己的服务器跟云相连, 但是本地的服务器不受aws管控, 而outposts是亚马孙在监管这些服务器 它时时刻刻监控服务器的运行状况, 云服务可以运行在亚马孙监管的服务器上面的 但是本地服务器是没办法运行aws的服务的

---

### AWS的网络服务
- 什么是网络?
- 虚拟网络和传统网络有些不同, 现在比较流行的方式 所有的网络都是通过网线连接起来 但是他们中间的逻辑并不是通过交换机和路由器来控制的 而是通过软件来控制的

- 这种网络控制的名字叫做SDN, 网络之间的传输并不是由硬件来控制了 虚拟网络也是通过软件来控制 通过软件帮我们定义的一个个的v-line 我们可以在云中创建自己逻辑的虚拟网络 v-line是将我们的网络分离成一个个的小通道 比如我们可以把一个大网络分成10来道路 通过v-line人工的在道路上加上一些的阻碍 走不到隔壁的道上去

- 通过v-line创建虚拟网络 通过其他的响应服务给我们的网络提供一些更多的内容
<!-- 
  它里面也有一些路由表 子网 ip分配都是通过软件来实现的
 -->

>>> 课后学习 TCP/IP的基础 IP地址的基础 最后要了解下V-Lan的概念


- 提到网络我们就要说一些高级的应用, 比如负载均衡器 -- *交警*
<!-- 
  什么是负载均衡器, 现在的社会中当客户量猛涨的时候 这个大的服务器达到它的极限了我又不可能重新买一台更大的过来 比如我已经配到最顶级了 不能再配了但是还是不够用, 我们创建一个一模一样的一台服务器, 然后前面我们加上一个类似交警一样的人 来了100个请求 但是服务器只能承载20个请求 我们交警在前面做限制, 交警说前20个到第一号服务器上去 中间20个到第二号服务器 后20个你到3号服务器上去

  通过负载均衡加上弹性扩展(垂直扩展是加cp 加内存 加配件 水平扩展将服务器不断的进行复制 然后通过负载均衡器将大量的请求 平均分交给后面的 因为都是复制的 你能承载多少 后面也是承载多少 分百分之多少给你剩下的交给下面的去处理 比如一根筷子很容易被大量的请求弄断 但是一百台就不会)
 -->

- 负载均衡器简单的来说 就是一台服务器不够了就加几台 人多力量大


> Amazon Virtual Private Cloud 
- 在云中预置一个逻辑隔离的部分，让您可以在自己定义的虚拟网络中启动 AWS 资源


> Elastic Load Balancing 
- 通过确保可扩展性、性能和安全性，让任何应用程序获得容错能力


> Amazon Route 53 
- 将最终用户路由到互联网应用程序的可靠且经济高效的方法
<!-- 
  DNS 起到的作用就是将一长串的数字, 跟网站的地址相连接起来 告诉我们这个地址对应的就是这个网站 它把域名和ip地址相互解析

  R53能做到在虚拟网络内部或者是在互联网上进行一个dns解析 可以通过r53购买一个域名 让它来对这个域名进行解析 可以将这个域名和本地的虚拟ip地址进行绑定 这样我想访问虚拟机的时候 就可以通过域名来访问就可以了
 -->


> Amazon CloudFront 
- 快速、高度安全且可编程的内容分发网络 (CDN)
<!-- 
  内容分发网络(CDN)
  比如我现在在日本 我们创建了一台服务器 上面放了一个网站 上面有些视频有写图片对日本本地来说 访问我们网站的速度很快

  有一个客户在美国距离日本6000公里 他要访问我们的网站需要多久 6000公里需要经过多少路由器 多少交换机 信号还要不断的衰减 还有出错的可能性 他等待的时间肯定非常的漫长

  为了解决这个问题, 在靠近美国的地方 我们租用一台存储器(亚马孙提供的服务存储)将客户经常要看的内容提前放一份 放到缓存里面(客户端的缓存) 第一个客户因为缓存中没有相关的资源访问页面等待时间长 体验可能很差 第一个客户发送请求, 响应相关资源的时候 同时往缓存中写了一份 第二个客户它所做的事情的 首先先访问靠近美国这边的缓存 去查看有没有客户要的内容 如果缓存中 那就从缓存中直接调用 不需要再到日本的网络去调用了 这样美国的客户的体验响应速度都得到了极大的提高

  那我怎么知道客户要看什么呢?
  1. 预先判断 常用的文章 图片 视频 我可以手动分发到缓存中 然后通过人工智能学习每张图片的浏览量 将浏览量从上到下的排序 浏览器最低的删掉 把容量空出来 再去检查今天有多少去访问别的内容 将浏览量多的放入到缓存中
 -->

- 内容分发网络就是靠近客户端的一个缓存将静态的资源客户经常会访问的内容放到靠近客户端的缓存当中 
- 比如我们在国外访问淘宝并不会感觉很慢 一方面可能是淘宝在我们本地有服务器, 或者靠近我们的国家地区有缓存


> AWS VPN 
- 将本地网络扩展到云并在任意位置对其进行安全访问
<!-- 
  vpn 我们翻墙使用到的工具 都是通过vpn进行翻墙 vpn类似vlan
  vlan是把网络通道人为的进行划分 放置类似虚拟的挡板在这, 防止走到另外一条道上
  vpn将我们走的道直接拿管子包起来外面人压根就看不见里面有东西, 它就像一个黑管
  外面人看不见里面传输的是什么内容 vpn就是将我们的传输胶囊化 给包起来

  vpn当初最主要的目的是为了安全的防护 不让别人偷窥我们传输的数据 现在被人利用来进行翻墙 翻墙本身并不一定需要vpn 但是vpn能够保证用户翻墙的时候 信息的安全
 -->



### AWS的数据库服务
> Amazon Relational Database Service (RDS) 
- 只需单击数下，即可在云中设置、运行和扩展关系数据库
<!-- 
  RDS可以想象成 有一个虚拟机上面装好数据库 你只管用就可以了 它提供的图形化的界面标准的saas服务
 -->


> Amazon DynamoDB 
- 适用于任何规模的快速灵活的 NoSQL 数据库服务
<!-- 
  是应对传统的关系型数据库不能处理的数据库
 -->


> Amazon Aurora
- 与 MySQL 和 PostgreSQL 兼容的关系数据库，性能和可用性与商用- 数据库相当，成本只有其 1/10
<!-- 
  Aurora是对开源软件进行模改后的糅合成的一个数据库 aurora 基本上可以看成模改的mysql服务 帮我们预先做好了很多的配置 性能很强
 -->


> Amazon ElastiCache
- 与 Redis 或 Memcached 兼容的完全托管型内存中数据存储。支持实时应用程序，亚毫秒级延迟
<!-- 
  Redis 数据库的缓存 它是靠近数据库端的一个缓存
  Memcached 

  AWS是基于linux底层的虚拟
 -->


> Amazon Redshift 
- 最受欢迎和速度最快的云数据仓库
<!-- 
  数据仓库也是一个数据库 传统我们处理数据库会按照行来处理 一行一行的进行搜索的读取

  数据仓库是按照列来进行处理 一列一列进行处理的 数据量大的时候处理的速度比较快
 -->

---

### AWS的容器服务
- 容器又是什么啊?
- 容器化 容器开发设计
- 容器指的是一种虚拟化的模式 跟我们虚拟机的模式略有不同 虚拟机的模式是将硬件进行复用 都是寄生在同一套硬件体系上可以安装多个操作系统 每个操作系统有自己的运行环境

- 容器服务是为了减少操作系统的开销 每一个环境都要安装自己的操作系统 容器在操作系统上面一层进行了复用 它的复用是将硬件和操作系统本身都进行了复用

- 操作系统只有一个 但是在操作系统上我虚拟出许许多多的沙盒 每个沙盒中都有自己的运行环境和自己的软件 这样就减少了操作系统的开销
- 容器开发是一个趋势 也得了解一下

> Amazon Elastic Container Service    ECS
- 运行容器的高度安全、可靠且可扩展的方式


> Amazon Elastic Kubernetes Service   EKS
- 最值得信赖的运行 Kubernetes 的方式
<!-- 
  Kubernetes:
  传统一个虚拟机管理一个容器 那假如现在有很多的虚拟机很多的容器 那就需要一个集中化的管理工具 它会将不同环境下的容器统一进行管理

  以前的虚拟环境是联通你的操作系统都一起要进行虚拟化 现在是操作系统不再管了
  我这个容器是在操作系统上面沙盒虚拟化 虚拟的是运行环境和软件本身

  既然是虚拟化 虚拟机 它就有自己的虚拟机的镜像 用来管理虚拟机容器的镜像 它叫做容器注册表
 -->


> AWS Fargate 
- 适用于容器的无服务器计算
- 容器化服务 由于容器都是基于虚拟机的 我们再创建容器的时候 我们首先要选择虚拟机的大小 在这个虚拟机上进行容器化
<!-- 
  我希望我在创建这些容器的时候 不希望再去管理底层容器的大小 不可能为了创建一个容器再去创建一台虚拟机 亚马孙为我们提供了无服务器的计算
  底层容器这块你自己负责 , 底层的虚拟机亚马孙帮你包了 你创建多少容器都可以 至于底层需要多少台服务器 你不用管 亚马孙帮你搞定
 -->


> Amazon Elastic Container Registry 
- 轻松存储、管理和部署容器映像
<!-- 
  我们设计好一个容器 我们做了一个镜像, 可以分发到别的容器上面去, 这个就是一个镜像 只不过里面是不带操作系统的
 -->

---

### AWS的Devops服务
> AWS CodeCommit 
- 安全托管高度可扩展的私有 Git 存储库。协作处理代码
<!-- 
  一个开源软件运行在他们的服务器上面给你提供服务 你不需要管它的后台是什么只管用就可以了
 -->


> AWS CodeBuild 
- 通过持续扩展构建和测试代码。只需按构建时付费
<!-- 
  多人写好各自的一段, 它会将这些代码整合起来进行编译
 -->


> AWS CodeDeploy 
- 实现代码部署自动化以确保应用程序的正常运行时间
<!-- 
  构建完成之后将我们的代码 自动部署好我们的测试环境 比如我们创建了一个虚拟机, 它将代码直接部署到虚拟机上 进行测试 将测试结果发送给你
 -->


> AWS CodePipeline 
- 自动化持续交付管道，可实现快速、可靠的更新
<!-- 
  整个过程通过这个codepipeline串联起来 它是后面的一条管道不断的往里放, 告诉我们下一步走到了哪里 这就是一个管道的设计
 -->


> AWS Cloud9 
- 用于编写、运行和调试代码的云 IDE
<!-- 
  比如我们的电脑性能对于开发来讲不够的情况下 亚马孙提供了这样的一个开发编辑器我们可以在云上开发 不需要在本地去安装环境 在云端直接写代码就可以了
 -->


- 在这些主流的服务背后 还有安全性的服务

---

### AWS的安全性、身份和合规性服务
> AWS Identity and Access Management (IAM) 
- 安全地管理对 AWS 服务和资源的访问
<!-- 
  验证你是你的服务 验证你的权限是什么
 -->


> Amazon Cognito 
- 简单安全的用户注册、登录和访问控制
<!-- 
  比如我们登录一个网站 我们需要在这个网站上登录用户名 和 注册
  假如我需要访问10个网站 那我们需要10个用户名 和 10个密码

  现在我们访问一个网站 除了我们需要去注册, 还有一种方式就是类似通过使用google账号去注册 这就是利用了第三方的身份地址池 就是我们在谷歌注册过了

  利用谷歌里面的用户名和密码直接给我们发放访问的许可

  这个功能就是通过Congnito功能来实现的
 -->


> AWS Certificate Manager 
- 轻松预置、管理和部署公有和私有 SSL/TLS 证书，以便用于 AWS 服务和您的内部互联资源
<!-- 
  证书
  密钥
 -->


> AWS Key Management Service (KMS) 
- 轻松创建和控制用于对数据进行加密或数字签名的密钥


> AWS Secrets Manager 
- 在整个生命周期中，轻松轮换、管理和检索数据库凭证、API 密钥和其他私密信息

---

- 下面的没细讲
### AWS的管理和监管服务
> AWS Auto Scaling 
- 扩展应用程序以便优化性能和成本


> Amazon CloudWatch 
- AWS 和本地的 AWS 资源和应用程序的可观测性


> AWS CloudTrail 
- 跟踪用户活动和 API 使用情况


> AWS Cloud​Formation 
- 借助基础设施即代码加快云预置


> AWS Systems Manager 
- 了解运行状况并对 AWS 资源采取行动

---

### AWS的成本管理服务
> AWS 预算 
- 设置自定义预算，让系统在您超出预算阈值时提醒您 


> AWS Cost Explorer 
- 直观看到、理解和管理随时间变化的 AWS 成本和使用情况


> AWS 成本和使用情况报告 
- 深入了解您的 AWS 成本和使用情况

---

### AWS的迁移服务
> AWS Server Migration Service 
- 将您的本地工作负载迁移到 AWS


> AWS Database Migration Service 
- 以最短的停机时间将您的数据库迁移至 AWS


> CloudEndure Migration 
- 自动帮你迁移到云端


> AWS Transfer 系列 
- 使用 SFTP、FTPS 和 FTP 将文件轻松无缝地传输到 Amazon S3


> AWS DataSync 
- 以最高 10 倍的速度将数据轻松传入和传出 AWS

---

### AWS的其他重要服务
> Amazon Simple Queue Service 
- 适用于微服务、分布式系统和无服务器应用程序的完全托管的消息队列


> Amazon Simple Notification Service 
- 完全托管的发布/订阅消息收发、SMS、电子邮件和移动推送通知


> Amazon Simple Email Service 
- 大规模入站和出站云电子邮件服务


> Amazon Kinesis 
- 实时轻松收集、处理和分析视频和数据流


> Amazon SageMaker 
- 面向所有开发人员和数据科学家的机器学习服务

---

### 参考资料 和 推荐的教科书
- aws官方网站
- https://aws.amazon.com/cn/

- aws官方教程

- Vstronix AWS视频课

--------------------------------

### AWS的存储服务
- aws只是一个平台它上面构建了很多的服务 是基于很多开源的软件加在自己的平台来做的 学好aws是指 除了aws本身的概念之外, 还要学好它周边的这些开源的软件 这是一个学习链 我们要学习常用的服务背后的东西也要学习 可能要花好几年的时间

> Amazon S3 简单存储服务 simple storage service
- 专为从任意位置存储和检索任意数量的数据而构建的对象存储
<!-- 
  我们一般进行存储的时候都是以2进制方式010101的形式写入到磁盘里面去 读取也是0101形成字节 通过比特形成byte...

  文件在系统眼里是散的一件件的拼接起来的 我们最早的叫做块状存储模式 系统看一个文件是一个零散的状态 我们要对这个文件更新的时候 我在里面修改一个字 对系统来说只需要更新文件中那一小块字节就可以了 这是传统的基于块状存储的一种模式

  s3的存储模式是把一个文件当做一个整体来处理的 在系统的眼里 s3里面的文件是一个整体, 它对文件进行更新并不是将文件中的一个部分删掉 再重新填上 不是打补丁的模式 它的做法是将文件整个删掉 重新放一个新的版本进去 这种模式就是基于对象存储

  它是平面画的处理方式 在s3的服务里面我们会创建一个个的存储桶(区分不同资源的) 我把文件放到存储桶中 我们可以将存储桶理解为一个文件夹的模式
  每个存储桶里面再将文件进行分类


  amazon s3提供了多种功能, 可供您以各种方式组织和管理数据, 从而支持特定使用案例
  实现成本效率 实施安全性并满足合规要求

  数据以对象的形式存储在名为 存储桶 的资源中

  单个对象大小的上限为5tb s3的特定中还包括诸多功能, 可以将元数据标签附加到对象, 跨s3存储类移动和存储数据, 配置并实施数据访问控制, 防止未经授权的用户访问数据, 运行大数据分析, 以及在对象级别和存储桶级别监控数据, 您可以通过s3访问点或直接通过存储桶主机名访问对象
 -->

- 在s3里面对文件的存储是基于每一个对象的 我们可以对里面的文件进行一个区分, 一个对象的生命周期, 指的是这个文件在存储桶里面需要多长的时间
- 我们可以对存储桶里面的对象 创建一个生命周期管理的策略 它会自动帮你检测 当这个文件创建以后超过多长时间之后 做什么 这种模式叫做生命周期的管理

- s3 根据它的访问程度对它进行分类

---

> amazon s3存储类别
- s3 标准
<!-- 
  放进去 取出来 我们正常的使用方式 也是用的最多的一种
  这种模式的存储速度是比较好的 因为是经常读取的 对硬盘要求会比较高
 -->

- s3 智能分层
<!-- 
  我把数据交给s3 我选择的类别是只能分层 在默认的情况下 把数据先放到s3的标准档位 然后运营一段时间之后根据读写对访问的数据进行分析 把不经常访问的东西从s3标准移动到s3标准访问

  说白了就是花了比s3标准稍微低一些的钱 让它帮你进行一个自动的分类

  生命周期是人工对文件进行分层 
 -->

- amazon s3标准 - 不经常访问(s3标准 - ia)
<!-- 
  对于不经常访问的文件 比如有一份文件可能1年也不会访问一次 特别是对归档文件来说
  我用性能比较低的磁盘来存储不经常访问的文件

  文件还是可以存储在那里, 因为使用的是不太好的磁盘, 所以存储费用会比较低
 -->

- s3单区 - 不经常访问(s3单区 - ia)
<!-- 
  s3的这种存储模式是高可用性的存储模式 我们把文件上传到s3 s3其实不是只有一份拷贝 它是在不同的可用区之间进行复制的

  我们在选择我们的服务的时候 我们要知道我们的区域在哪里 第二个是我们的可用区在哪里 一般我们会选择里我们近的可用区的服务

  我们上传的文件会在2-3个可用区之间复制 比如我们再日本东这个大型的区域里面有3个大型的数据中心 我开通了一个s3 我往上面传递了一个文件, 在我们看来只有一份文件
  aws的处理方式是在这3个可用区之间都放一份对数据的拷贝 这样的好处就是 有一个可用区出现了问题 还有另外两个可用区的数据备份供你使用

  但是到底我们是使用了3个可用区 所以这个费用还是比较高的

  s3单区指的就是 我不需要放3个拷贝
 -->


- amazon s3 glacier (s3 glacier)
<!-- 
  当我的文件比90天更长 1年都没有人访问, 智能分层就会让它往下沉
  glacier不是再使用磁盘对数据进行存储 它是使用过去最早的方式通过磁带来存储

  这种技术非常的成熟 价格也非常的便宜 会让成本进一步的降低
 -->


- amazon s3 glacier deep archive(s3 glacier deep archive)
<!-- 
  如果数据7 8 年都不访问一次 可以将数据继续下沉 深度归档
  s3 glacier是将数据备份到大磁带上, 大磁带还是一直在机器上转的
  它一直会等待有人会来进行索取

  深度归档的意思是 不再放在机器上等待别人的访问了
 -->

- 以上可以说是将存储的费用从最高降到了最低 但是有没有什么代价?
- 从高速降到低速降到磁带 磁带的速度就非常的慢了 检索的速度比较慢
- 越是读取速度慢的 检索的费用就会高一些
<!-- 
  比如 s3 glacier deep archive 它是把磁带拿下来放在一个恒温仓里面, 假如我们要检索这上面的数据
  从数据存储上讲, 可能会很便宜 1-2分钱放一个tb
  从检索上来讲, 检索前要先联系,他们从磁带从恒温室里面拿出来放到磁带读取机上去
  所以这种检索的响应时间非常的慢甚至要到20几个小时 才能开始去查信息 把磁带需要全部读取一遍, 检索的费用就会比较高一些
 -->

- 总的来说 存储费用越往下越少, 但是检索费用却越来越高

- s3 outposts
<!-- 
  把一个机柜放到公司直接当你们的内网 机柜中的东西是不能动的 它是通过专线让机柜和amazon相连的 等于说把托管的机柜没有放到amazon的数据中心而是放到你们公司的数据中心里面去了

  既然是内网那即便是断网你的服务还是可以是继续的
  这个是最新比较流行的模式
 -->


> Amazon s3限制
- 默认情况下, 您可以在每个aws账户中创建多大100个存储桶, 如果您需要更多的存储桶, 则可以通过提交服务限额提升请求将账户的存储限制提高至最多1000个存储桶


- 单个对象大小的上限为5tb, 存储桶归创建它的aws账户所有 存储桶所有权不可转让
- s3的速度很低, 不适合需要告诉传输的场景
<!-- 
  比如说我们的操作系统 它不适合做系统盘和数据盘 它的速度很低
 -->

- s3是全球性的, 所以命名是全球唯一准则


> s3存储桶的加密
- 这部分是分两块的 一是对访问的数据安全 二是关于数据本身的数据安全 对于s3来讲 存储桶是有一个加密的功能

- 加密有3种类型
- 1. amazon s3托管密钥的服务器端加密(sse-s3)
<!-- 
  这个就是我们什么都不用管 我们在读存数据的时候是通过s3自己帮我们做的加密
  这个密钥是s3自己管理的 我们也不需要知道这个密钥在哪里
 -->

- 2. 让aws创建一个密钥服务 创建一个让aws托管的密钥 这个密钥是看得见的 我们也可以进行下载, 它本身是由服务器进行管理的
<!-- 
  也就是说 我们不是使用s3自带的密钥, 而是自己创建了一个密钥
  AWS key management service 就是一个创建密钥 和 管理密钥的工具
 -->

- 3. 最后一种就是客户自己提供加密
<!-- 
  就是数据上传的自己我们自己打包放一个密码 这个就是跟s3没有任何关系了
 -->

- 一般最安全的方式就是我们使用s3的加密就可以了

<!-- 
  PPT中理解性知识点
  - 具有amazon s3托管密钥的服务器端加密(sse-s3)
  - 当您使用具有amazon s3托管密钥的服务器端加密(sse-s3)每个对象均使用唯一密钥加密 作为额外的保护, 它将使用定期轮换的主密钥对密钥本身进行加密, amazon s3服务端加密使用可用的最强数据块密码之一(256位高级加密标准(aes-256))来加密您的数据

  - 在AWS key management service中存储客户主密钥(cmk)的服务端加密(sse-kms)
  - 在aws key management service中存储客户主密钥(cmk)的服务器加密(sse-kms)与sse-s3类似 使用该服务具有一些额外的好处, 但也要额外的收取费用

  - 使用cmk需要单独的权限, 该密钥可进一步防止未经授权地访问amazon s3中的对象, sse-kms还向您提供审核跟踪, 显示您的cmk的使用时间和使用者, 此外 您还可以创建的管理客户托管cmk 或者使用您, 服务和区域独有的aws托管cmk

  - 使具有客户提供密钥的服务器端加密(sse-c)时, 您管理加密密钥 而amazon s3管理加密(它对磁盘进行写入时) 和解密(在您访问您的对象时)
 -->


> Amazon s3访问控制
- 由于它是基于云端的服务, 对于访问来讲是有一个严格的控制模式的 它是通过访问控制列表 和 存储桶的策略 进行控制的
<!-- 
  就好比我们访问需要门禁, 必须里面的人同意我们访问我们才可以访问, 不同意访问的我们是没有办法访问的

  通过这种方式保护一个访问的安全
  默认状态下s3是不让公有访问的 所以我们创建存储桶的时候, 会做一个实验 我们启动公共访问和不启用公共访问做一个比较
 -->

- 我们除了访问列表之外 还有一种基于策略的模式对访问的控制
- 一种是放在存储桶上的策略
- 另外一种是基于用户的策略
- 所有关于策略的这一块就是基于json语言的 json一般用来进行存储数据的而不是用来做开发的

<!-- 
  PPT中的知识点
  访问策略的方式
  - 当amazon s3接收对象操作的请求时, 它会对存储桶或者说对这个用户进行一个评估
  - 比如存储桶上有一个策略 用户上有一个策略 它有一系列的东西来判断它有什么样的权限

  比如我们去要一个公司找一个部门经理
  门卫就是第一步    (对象访问控制列表)
  进入到具体的哪个楼里面    (存储桶策略)
  进入到办公室    (存储桶acl)

  这就是多重策略 一般来说我们不会给每一个层级都设计策略 只会让管理上非常的困难

  只有在明确的允许的情况下我们才可以访问, 如果没有的话 就是不允许访问
 -->

- 显性的拒绝大于一切, 隐性的拒绝大于隐性的允许
- 除非有显性的允许, 没有显性的拒绝 才有访问权

---

### Amazon Elastic File System   EFS
- 可扩展的、弹性原生云 NFS 文件系统
- 说白了就是一个共享文件夹
- 本质上也是基于块状读取 但它是一个文件

- 它会在aws上面设置一个共享文件夹, 它在云端设置了一个共享(以前设置共享必须要在内网里面)就意味着大家不需要人在办公室里面 都可以访问一个共享文件夹, 去协调工作
- 减少了vpn实际上是一个很方便的服务

<!-- 
  PPT文档:
  NFS 文件系统 文件共享 共享文件夹就是一个nfs
  ams在云上设置好了一个共享文件夹, 别人可以通过链接地址在本地使用这个共享的文件夹

  可提供简单, 可扩展, 完全托管的弹性NFS文件系统, 以与AWS云服务和本地资源配合使用, 它可在不中断应用程序的情况下按需扩展到pb级

  随着添加或删除文件而自动扩展或缩减, 无需预置和管理容量, 可自适应增长

  Amazon efs有一个简单的web服务界面, 允许您快速 轻松的创建和配置文件系统, 该服务为您管理所有文件存储基础设施 这意味着您可以避免部署, 修补和维护复杂文件系统配置的复杂性


  它也是分布在多个可用区, 也是放了3份拷贝
 -->


> EFS中的数据加密 分为两种
- 1. 静态加密
<!-- 
  文件放在里面的时候是怎么加密的
 -->

- 2. 动态加密
<!-- 
  我在本地在跟efs进行数据传输的时候 在传输的过程中进行加密
 -->


> EFS 性能模式
- 说白了就是便宜的用一个普通的性能
- 通用性能模式

- 多加一点钱就提供一个更为高速的
- 最大 I/O 性能模式
- 允许更多的人来进行同时的操作自然要多话一点钱

---

### Amazon Elastic Block Store    EBS
- ebs是块状的存储 就是最传统的硬盘的存储方式, 在虚拟机挂载磁盘的格式就叫做 ebs
- ebs就是一种磁盘
- 易于使用、适用于任何规模的高性能数据块存储
- 基于块状
<!-- 
  虚拟机上的一块硬盘 硬盘又分好多种类型 我挂载到我的系统上 决定大小和速度 付的钱多那性能就是好的

  既然是电脑磁盘那就会分为很多的种类 根据速度容量性能进行分类
 -->

> EBS的卷类型
- 1. SSD
<!-- 
  ssd类似于闪存 里面并没有机械的东西在里面读取 ssd在性能上来讲会比hdd好很多
  它的优点是对频繁的读写的小型操作非常的优化

  它可以比喻成电动车
 -->

- 2. HDD
<!-- 
  它是传统的磁盘 用磁头在上面读取 很多小光盘堆在一起 让磁头在上面读
  便宜一些 速度慢一些 比较适合大型吞吐类大流量的进行处理

  它可以比喻成烧汽油的车
 -->

- s3属于最好的那种也属于HDD 它的速度不快很慢 每秒大概在300md/s 它主打是做备份做文件存储


> EBS快照
- 我们可以理解为ghost 将我们的磁盘完整的复制
- 快照是做备份使用的 比如我的系统 我要做一个快照 相当于将我们的磁盘整个读取下来放到了另外的一份拷贝里面去 这个拷贝可以在需要的时候恢复出来 , 通过这个快照再生成另外一台虚拟机

-------------- 下面的了解相关的体系即可 上面的前三种很重要

> AWS Storage Gateway 
- 对几乎无限的云存储的本地访问权限
<!-- 
  在本地设置一个缓存, 通过这个缓存(其实就是代理) 通过这个代理将本地存储和云存储之间进行同步

  当创建这个代理的时候相当于设置了虚拟机 然后里面放了一个文件缓存的地方 不管是上传到云还是下载 先放到缓存这里 这个缓存会在本地映射一个盘符 可以直接进行访问

  算是一个中介
 -->


> AWS Snow 系列 
- 高度安全且便携的设备收集和处理边缘位置的数据，并将数据迁移到或迁移出 AWS
<!-- 
  大号的U盘 40-60tb 一个真实的设备 还有更大的硬盘卡车 将数据进行迁移或迁移出

  1000兆 上传100tb的东西要9天 那假如我们要3天迁移完毕怎么办
  100TB = 100 X 1024G X 1024M / 125
 -->

比如在柜子里把照相机拿过来 这时候我们文字字符串的形式没办法锁定一个物件

计算机里面也是 比如有个空间我们要存储一个数据 比如当前的资料 用户的购物车数据

可能要把用户的权限的信息也放在这里面 只要我去这个容器里面找 就能找到这个数据
如果我们往这个空间放数据的时候 起字符串的格式 apple 可能会有重名的问题 后面的会覆盖掉前面的 我们会加前缀 组件也是 为了区别我们要使用字符串

让一个值永远是唯一的

- 上云服务最主要的就是能解决成本 再加上它的灵活性 弹性

----------------

### 实操环节
- s3一般是对内使用的不对外开放

- 对象url
- 我们在创建的存储桶里上传文件后 点击文件名有进入的页面 右侧有一个对象url
- 格式 存储桶.s3.区域.amazonaws.com/文件名

- 假如我们开启了版本控制 那么每次更新的时候 其实都是再对前一份文件重写
- 完全覆盖, 那版本控制适合做什么?
- 我们可以用存储桶控制我们的代码 我们可以不用github

- https://calculator.s3.amazonaws.com/index.html
- 计算s3费用的网址

- 思考题
- 为什么我们设置了所有人都可以访问, 但是我们还是不能通过url访问到图片
- 没有明确允许的情况下一定是拒绝
- 小区是对大家打开的 但是大楼门卫没有明确让你进来

- 在存储桶 属性 最下面 有一个静态网站托管
- 我们可以将s3的存储桶当一个网站 可以把网页放在上面 这样我们就可以把存储桶做一个网站来使用


- 445号端口开启 linux

---------------------------------

### AWS的计算服务
- AWS最主要的是云计算的部分, 存储只是附带的
- 我们使用的本地虚拟机都有什么? 

> 虚拟机的原理是什么?
- 我们正常的电脑在使用的时候 很少有情况能够把处理器用满 正常的使用率大概在20% - 70%之间 平均有50%的计算性能都是出于闲置的状态

- 有一家公司提出的概念将我们系统剩余的资源, 拿出来通过软件来管理从头到尾将它和你现有的系统进行一个逻辑上的切割 形成一个完整的计算单元 简称叫做虚拟机

- 所以它并不是用软件和磁盘来虚拟一个系统 它是将你的处理器 硬盘 内存 甚至网络作为一个整体和你现有的机器进行一个切割 逻辑的切割 人为的将一部分逻辑拿出来 不对你当前的系统进行开放 形成独立的系统 这种叫做虚拟机

- 虚拟机有很多种类型
- linux下的kvm系统是最常见的一种方式


### Amazon EC2  elastic compute cloud 
- 弹性计算云
- EC2是一个标准的虚拟机 在linux上的一个虚拟机
- 安全且可调整大小的计算能力，支持几乎所有工作负载
<!-- 
  好比租用 租多久付多就的钱

  paas定义 帮你装好了操作系统 和 软件的运行环境 直接上传和写入代码即可 操作系统和软件的运行环境都是托管的看不到的 你也管不到

  EC2是一个虚拟机 你可以进入系统 你可以安装自己想要的软件 你可以修改里面的东西 它一定是iaas 不是paas因为paas是没有办法进入操作系统的

  iaas 提供了最基础的硬件, 即操作系统网上需要我们自己去维护
  paas 软件代码之外的东西都帮你配置好 只要专注于自己的代码 专注于自己的软件即可
  saas 你连软件都不用写了
 -->

<!-- 
  PPT上的知识点
  ec2 是一种web服务, 能在云中提供安全且可调整大小的计算能力, 该服务旨在让开发人员能够更轻松地进行web规模的云计算, amazon ec2的web服务接口非常简单 您可以最小的阻力轻松获取和配置容量, 使用该服务, 您将能完全控制您的计算资源, 并能在amazon成熟且行之有效的计算环境中运行
 -->


> EC2 实例类型
- amazon ec2 提供多种经过优化, 适用于不同使用案例的实例类型以供选择, 实例类型由cpu 内存 存储和网络容量(网卡的速度)组成不同的组合, 可让您灵活地为您的应用程序 选择适当的资源组合, 每种实例类型都包括一种或多种实例大小, 从而使您能够扩展资源以满足目标工作负载的要求

- 根据 cpu 内存 存储和网络容量(网卡的速度) 构成的一些选项

- 1. 通用计算类型
<!-- 
  普通内容搭配
 -->

- 2. 计算优化型
<!-- 
  处理器这块强一些 存储量大一些, 内存少一些
 -->

- 3. 内存优化型
<!-- 存储量大一些 -->

- 4. 加速计算
<!-- 可以选配显卡 来提供一些高速的运算 -->

- 5. 存储优化
<!-- 给一个高速的磁盘选项 -->

- 不同的计算类型 收取的费用也不一样 我们要根据实际的需求来进行选择


> 实例的性能
- 比如我创建一个4核处理器 8g内存 100g的硬盘 100MB的网卡 正常的一个虚拟机
- 正常情况下, 我们运行处于一个满负荷的状态下是很正常的 
- 当的时候我们需要我们的处理器在某些情况下支持一个突发情况下的突破 比如双11
<!-- 
  双11 我买了10台虚拟机 能够承载1000万人, 但是11那天有1200万人来访问我们的网站 这样就超出了 我们虚拟机的能力

  但是我又不想因为短时间的增长丢失了这些客户

  ec2就推出了 这个突发性能实例
 -->

- 会根据我们的实际情况 可以帮我们在段时间内 提高我们整体的性能 大概可以提高120% 临时的提高 但是需要消耗cpu积分这个东西  
<!-- 
  CPU积分:
  虚拟机也不可能是100%的负荷 当虚拟机处于30%的负荷的时候 有70%是空闲 这个空闲的部分可以变成cpu的积分 

  每个T实例都会持续受到cpu积分, 其频率取决于实例大小
  T实例会在其空闲累计CPU积分, 然后在活跃的时候使用cpu积分, 一个cpu积分可以在一分钟内提供完整的cpu核心性能

  空闲比例越长 积分就越高 积分是有一定的上限的 最高的累计数量是288个积分
 -->

- 其实这种突发性的性能增加是找别人借的 向那些空闲的人借的 aws会监控看谁的剩余资源比较多, 然后当有人有突发情况的时候将空闲资源借给这个人 会消耗cpu积分积分用完了就恢复成100%


> 多存储选项
- amazon ebs提供最佳满足工作负载需求的三种卷类型
- 1. 通用ssd
- 2. 预配置iops(ssd)
- 3. 磁性介质
<!-- 
  PPT文档:
  amazon ec2让您可以根据需要在多存储选项之间进行选择, amazon ebs是一种耐久性块级存储卷, 可以连接到单个正在运行的amazon ec2实例, 可以使用amazon ebs 作为主要存储设备, 以获取需要频繁更新和惊喜更新的数据

  很多amazon ec2实例还能包括物理连接到主机上的磁盘中的存储 这种磁盘被称为 实例村粗, 实例存储可为amazon ec2实例提供临时性块级存储, 实例存储卷上的数据的保存期限等于关联amazon ec2实例的使用寿命
 -->



> EBS优化
- ebs优化实例是通过read的这种模式实现对吞吐量的提升 当然也意味着你要支付更多的费用

- ebs其实是跟虚拟机进行捆绑的 ebs是一种硬盘(从真实的硬盘中虚拟出硬盘来供你使用) 
<!-- 
  知识扩展
  hdd: 以前我们使用的hdd是一种机械硬盘里面是一种很多磁片叠加起来 里面有很多的磁头在里面读 通过磁性来修改磁盘中的01
  这种磁盘是物理结构噪音比较大 它也是机械结构很容易坏

  大磁盘能做到的读取速度大概是160mb/s 

  后来兴起了固态硬盘, 固态硬盘我们可以理解为高速的闪存 u盘也是固态硬盘的一种


  Ssd: 也是目前我们用过最多的一种 它根据接口不同类型也分很多中
 -->

- 在虚拟机的世界里也存在这些配置 我们使用最多的也是ssd 它们称为通用的ssd(简称gp2)
- 另外一种叫做iops(每秒读写的速度根据不同的速度还分为io1 io2)
- 最后一种就是hdd

- 我们在创建虚拟机的时候也要选择磁盘的类型 和 磁盘的大小 不同的磁盘类型适用于不用的场景一般我们选择通用的SSD类型就够了

- 比如大型数据库要告诉读写的话 我们就必须使用iops(高性能的ssd) 不然的话客户读取会处于一个长期等待的状态

- 对于磁性介质来说 最大的优点就是便宜 适合做存储使用

- 另外选择虚拟机的类型不一样 安装的磁盘的数量也是不一样的


- 针对吞吐量和类型进行变更 除了支持最高上限的iops外还支持了同时对多个磁盘并联在一起同时读写从而提升速度(read123磁盘的类型)
<!-- 
  read的优点的是多个磁盘并联在一起可以同时读写 比如 原来我把1234写到一块硬盘上
  现在我把1 3 写到一块硬盘上, 2 4写到2号硬盘上 这样我有双通道过去 每个写入的速度只有原先的一半 等待的时间也就减半了 从而提升了速度 读取也是一样的
 -->


> 置放群组
- 在可用区内部的实现高可用性的一种方式
- 区域
- 可用区
- 置放群组
- 上面的三个从上到下依次排列
<!-- 
  比如每一个公司我们创建了10台虚拟机 那这个虚拟机我们要放在什么地方
  比如我今天创建一台 明天创建一台 后天创建一台 他们会在同一个物理机房么?同一个物理服务器上? 或者说同时创建的多台虚拟机会不会在同一个硬件服务器上

  不一定

  不在同一个硬件服务器上的好处是之前我们了解的区域和可用区的概念, 当我们的数据放在多个可用区的时候 当有地震的时候 我们能确保我们的数据还是能用的

  好处就是 当我们随机放在不同的随机的硬件上面的时候, 当可用区里面出现了问题还可以实现部分的性能

  所以在默认的情况下 我们是将虚拟机分开的 但是还是有需求让创建的虚拟机都在一起

  虚拟机分开可以在有意外的时候出现高可用性 但是增加了延迟性 因为所有的硬件不是在一台主机上 一定是通过网络跟另外一台虚拟机进行链接

  对延迟非常非常介意的企业 可以将所有创建的虚拟机放在同一个服务器 那就属于服务器内部的链接 这样延时可以达到最低
 -->

- 1. 分步式
- 尽可能的将你的服务器打散放置在不同的硬件上
<!-- 
  将一小组实例严格放置在不同的基础硬件上以减少相关的故障
 -->

- 2. 集群
- 最大限度的将虚拟机全部放在一起
<!-- 
  将一个可用区中靠近的实例打包在一起, 通过使用该策略 工作负载可以实现所需的低延迟网络性能, 以满足HPC应用程序通常使用的紧密耦合的节点到节点通信的要求
 -->

- 3. 分区
<!-- 
  将实例分布在不同的逻辑分区上, 以便一个分区中的实例组不会与不同分区中的实例组使用相同的基础硬件, 该策略通常为大型分步式和重复的工作负载所使用
 -->


> 快照 snapshot
- 快照的作用主要是能够进行在线数据备份与恢复, 当存储设备发生应用故障或者文件损坏时, 可以进行快速的数据恢复, 将数据恢复到某个可用的时间点的状态

- 快照的另一个作用是为了存储用户提供了另外一个数据访问的通道, 当元数据进行在线应用处理时, 用户可以访问快照数据, 还可以利用快照进行测试等工作, 所有存储系统, 不论高中低端 只要应用于在线系统, 那么快照就成为一个不可或缺的功能

- 快照在aws中主要是用来做一个备份的使用 快照的本身就是将当前的磁盘 或者是系统盘+数据盘做一个完整的1:1的拷贝

- 快照在aws里面就是一个完整的拷贝 我们可以只拷贝数据盘 只拷贝系统盘 也可以全部拷贝 既然是一模一样那就意味着 可以通过快照创建一个跟虚拟机完全一样的副本
<!-- 
  比如我在日本创建的快照 我将快照复制到美国地区 那另外一个人是不是可以创建一台跟你一样的虚拟机呢

  那就是说整个公司标准化统一化的时候 我们只需要确保所有虚拟机的创建都是按照同一个快照创建的 那它肯定是一样的

  快照是一个完整的复制连同系统数据一起复制的
 -->

- 快照是纯粹的对磁盘进行复制
- 镜像是包括你的系统配置一起拉(连同虚拟机配置一起 快照只针对磁盘(数据))


> amazon ebs快速快照恢复(fsr)
- 快照保存下来是放在s3里面的 但是s3中的性能很低下, 亚马孙还提出了快速快照恢复
- 恢复的时候是从s3读取创建一个ebs 

- 快速快照恢复 不是将备份放在s3中 而是放在了另一块ebs 这个ebs使用的是ssd 这样响应的速度就快了 我们所要做的就是为这个快速快照的恢复多付一份钱





### AWS Elastic Beanstalk 
- 它就是标准的ec2加上一个软件的运行环境
<!-- 
  PPT资料:
  - AWS Elastic Beanstalk 是一项易于使用的服务, 用于在熟悉的服务器(例如apache nginx passenger iis)上部署和扩展使用java net php node python ruby go docker开发的web应用程序和服务

  - 您只需要上传代码 elastic beanstalk即可自动处理包括容量预配置 负载金恒 自动扩展和应用程序运行状态监控在内的部署工作 同时 您能够完全控制为应用程序提供支持的aws资源, 并可以随时访问底层资源

  - elastic beanstalk不额外收费 您需要为存储和运行应用程序所需的aws资源付费
      上面这句话是 背后的虚拟机要付费 它的费用和ec2费用差不多
 -->



- 简单易行，无限扩展
- 标准的paas服务, 除了帮我们配置好操作系统之外, 还帮我们处理软件的运行环境

- paas服务那就说是针对http https的一种服务 上面可以选择我们软件运行的环境

- Elastic Beanstalk 可以说是在ec2上帮助我们安装好了这些(java net php node python ruby go docker)运行环境 我们需要做的就是只需要上传我们的代码

- 自己写软件
<!-- 
  基于EC2 帮助我们把平台都安装好了 直接使用就可以了 paas服务
  操作系统 和 软件的运行环境都是准备好的 你所要做的就是把你的代码上传上去

  它是标准的paas服务 你对服务器并没有太多的控制权

  不好的地方在于 创建elastic beanstalk的环境配置起来比较繁琐
 -->

- 假如我们要运行的环境 elastic不支持怎么办 比如我就是要用旧版本进行开发
- 我们直接使用ec2
- 很少人使用elastic beanstalk 据说不好用





### AWS Lambda 
- 无需考虑服务器即可运行代码只需按使用的计算时间付费(秒)
- 有点像上面的elastic beanstalk把你需要的东西都给你搭建好了, 跟elastic beanstalk不一样的地方就是 你不需要选择虚拟机的大小 再选择各种各样的配置

- 出发点是从paas出发的 paas快要到saas里 但是由于代码是自己写的所以永远是够不到saas这块的

- 只要拿着代码都可以在lambda上面直接运行 它是一种无服务器的模式 也就是说你不需要考虑服务器的存在
<!-- 
  按照运行的次数和时间来进行付费 跟我们打电话很像 按时间次数收费 游戏厅投币的感觉

  上面接触到iaas paas saas有一个共同的特点就是必须知道后台服务器的大小 大小就是说服务器的配置

  适合短期运算 和 非常规运算适合这种模式 我们使用无服务器的模式 优势更加的节约成本

  它每次运算最多15分钟 它适合短期的运算

  适合的场景: 公司报表一年一次, 

  银行的按揭查询就是无服务器的计算
 -->

- 缺点:
- 1. 它有运行时间的限制 最大只能运行到15分钟默认的情况下
<!-- 
  内存是128 - 3008 以64mb为增量
 -->

- 2. lambda使用的资源是有限的 因为是无服务器的模式 不代表你可以使用无穷大的计算它是有限制的 你可以使用都大的内存去计算

- 解决方案:
- 我们可以把代码切分成好几个部分, 每一个部分在一个lambda中运行 根据第一个返回的值调用调用第二个lambda 第二个完事再调用第三个 ... 从而实现了打破了15分钟的限制
<!--  
  亚马孙官方使用的语言是python
 -->

- Lambda是直接运行在aws上的一个计算单元 它可以很方便的和其他的aws的资源相集合 比如可以通过lambda调用所有运行在ec2上的日志 进行检查发现问题后通知我们
<!-- 
  以后会发现 很多地方都是基于两个东西, 一个是日志 还有就是lambda
 -->


> AWS step functions
- 把整个步骤打散了并不是放到一起去执行(15分钟的限制), 现在可以打散了分步执行(分为多个lambda去运行) 

- 上面提到的可以将代码分几个部分放到不同的lambda中运行 这个就叫做 step functions

- 将我们的代码打散了 突破了15分钟的限制 但是因为内存3008mb有限制不适合大规模运算的 因为它没有足够的规模进行运算


<!-- 
  PPT资料
  - 它是一个无服务器函数编排工具, 可轻松将aws lambda函数和多个aws服务按顺序安排到业务关键性应用程序中

  - 通过其可视界面 您可以创建并运行一系列检查点和事件驱动的工作流, 以维护应用程序状态, 每一步的输出作为下一步的输入, 应用程序中的各个步骤根据业务逻辑定义的顺序执行

  - 编排一系列无服务器应用程序, 管理重试和调试故障可能颇具挑战性, 随着分步式应用程序变得越来越复杂 管理他们的复杂性也随之增加, step functions 可自动管理错误处理, 重试逻辑和状态, 凭借内置的操作控制功能, step functions可以管理执行任务的书序, 错误处理, 重试逻辑和状态, 从而显著减轻团队的运营负担
 -->





### Amazon Lightsail 
- 它是一个小型的虚拟机系统 它上面安装好了一些相关的小服务 它类似于paas的服务 也可以提供iaas服务 也可以提供saas服务

- 横跨 iaas paas saas的服务

- 以可预测的低廉价格获得虚拟服务器、存储、数据库和网络
- 它介于 ec2 和 Elastic Beanstalk 之间 可以创建一个小型的虚拟机给自己做网站的服务
<!-- 
  虚拟私人的小服务器 相当于配置好的ec2 只需要选择上面搭载的最终服务是什么
  它是一个小型的服务器 跟ec2类似比ec2简单很多 不需要考虑后面的数据库 网络存储等是什么 我们只需要选择数据库的大小  具体的数据库的类型不需要管
  比如我们创建好了一个小型服务器 把我们写好的网站直接丢在上面就可以了
 -->


> AWS Outposts 
- 就是一台放在公司内部的亚马孙的机柜
- 运行本地 AWS 基础设施和服务以获得真正一致的混合体验
<!-- 
  亚马逊在你公司的本地放一个机柜 放上他们托管的服务器 这个服务器本身是放在你办公的地点 通过专线或者vpn跟亚马孙直接去链接

  因为自己的公司拉一条到aws的专线是很贵的 所以aws提供了一个低延迟 又能享受云端服务的

  我们好不容易上云, 亚马孙又把一部分的服务器放在我们本地的机房 为什么?
  安全 速度快 独享设备

  虽然亚马孙把服务器放到了本地, 但是我们对这台服务器没有拥有权 服务器还是由亚马逊来管 它的好处是在数据传输不用通过网络上传到云上 你的数据是跟本地进行交流 一是速度快 二是安全

  设备独享
  云上有很多的虚拟机, 但是这些虚拟机 并不是你自己独享的

  这些服务器放在你们公司 虽然你不能碰 但是我能确保这些服务器是你们公司独享的
 -->

- 有些数据比较敏感的不需要去上云 我们本地的自己的服务器跟云相连, 但是本地的服务器不受aws管控, 而outposts是亚马孙在监管这些服务器 它时时刻刻监控服务器的运行状况, 云服务可以运行在亚马孙监管的服务器上面的 但是本地服务器是没办法运行aws的服务的

--------------------------

### AWS的网络服务
<!-- 
  前端访问数据库 指定ip地址比较好 还是dns好
  假如:
  ip地址          dns
  18698712060    刘春杉
 -->

> ipV4的地址
- 它是一个32位的地址 我们通过0和1进行表示, 每8位后面加一个. 翻译过来就是xxx.xxx.xxx.xxx

> ipv4中私有的ip地址有哪些? 有哪几个网段?
- 有3个
- 1. 10.0.0.0 -8
- 2. 172.16.0.0 -12
<!-- 
  -12 是从 172.16.0.0 - 172.31.255.255

  这些就是地址范围
  所以说为什么我们公司的地址会是以 
  172.16
  172.31
  192.168
  10.
  开头的

  是因为它们被保留下来作为私有的ip地址
 -->

> 子网掩码
- 它也是32位 前面多少位是用来表示网络段 后面多少位是表示地址段(还需要补足基础知识)

-----

### Amazon Virtual Private Cloud    VPC
- 这里讲的是一个虚拟网络的概念, 虚拟私有云

- 之前我们学的存储服务类似于百度网盘 是一个对内对外提供服务的接口
<!-- 
  我们在访问我们的s3或者文件共享的时候都是从公网地址进行访问的
  比如我们的s3为什么能够对外提供一个静态网站 因为它是一个公共的ip地址

  我们在创建我们的虚拟机(ec2 实例)之后 我们从虚拟机访问s3 也就是从ec2里面去访问s3是怎么走的网络? 是公网

  为什么? 明明都是aws的东西走的还是公网? 

  如果不做什么设置的话, 从虚拟机去访问aws里面的服务都是走的公网 这是很麻烦的所以我们要把网络单独拿出来说 因为网络属于背后的架构 我们要对这部分知识相当的了解

  要自学: 网络的相关知识 (网络工程师相关知识)
 -->

> 虚拟网络
<!-- 
  VLAN:虚拟局域网

  VLAN就是虚拟局域网，是一组逻辑上的设备和用户，这些设备和用户并不受物理位置的限制，可以根据功能、部门及应用等因素将它们组织起来，相互之间的通信就好像它们在同一个网段中一样，由此得名虚拟局域网。
 -->

- 虚拟网络还在构建在物理网络之上的
- 虚拟网络是将物理网络多余的带宽 拿出来人为的划分出来 形成多个互相逻辑隔绝的小的局域网

- 亚马孙里还是靠传统的物理网络(光纤 交换机 路由器), 由于我们的云是看不见莫不着的东西 我们在分配资源的时候也不可能将全部的物理线路交给你


- 我们在电脑上的虚拟机, 是根据我们多余的计算能力拿出来进行一个逻辑的隔绝 形成一个自己的沙盒
<!-- 
  在网络世界里 比如我们的带宽是1000兆 我们网络上面所有的东西长期的跑在10兆左右 我们有990M的带宽都是空余的

  我们通过虚拟机的模式人为的将网络带宽逻辑划分成很多小的虚拟的网络
  比如说我建立了一条公路 公路大概是100米宽 上面也没有画任何的线 车很少1 2辆在公路上跑 我觉得100米太宽了 我们在公路上画线 人为的将公路隔开划分
  1米一条道 车在道上行驶

  这种人为的划分我们可以理解成将物理的网络进行虚拟化 形成了一个虚拟的局域网
  车道的名称我们可以说是一个tag

  别人在行车的时候 1车道上的车可以走到哪里去 2车道的车可以走到哪里去 我们在划分的时候就可以进行规定
 -->  

- 之前我们在创建虚拟机的类型的时候最后一项是关于网络这块是速度低速 中速 高速, 这就意味着我们创建虚拟机的时候选择什么样的速度代表我们跑什么样的车道(是60km/h的低速 还是80km/h的中速 还是100) 跑的越快付钱越多嘛

- 虚拟网络在亚马孙这就相当于把自己公司特别大的一个带宽拿出来分配 划分出来一个你可以使用的网络 这就是一个虚拟的局域网

- 这个虚拟的局域网 就叫做 Virtual Private Cloud 虚拟私有云
<!-- 
  PPT资料:
  借助 VPC 可以在aws云中预置一个逻辑隔离的部分, 从而在自己定义的虚拟网络中启动aws资源, 您可以完全掌控您的虚拟联网环境, 包括选择自己的ip地址范围

  创建子网以及配置路由表和网络网关, 您在vpc中可以使用ipv4 ipv6 因此能够轻松安全的访问资源和应用程序

  您可以轻松自定义 vpc 的网络配置, 例如 您可以为web服务器创建一个能访问internet的公有子网, 此外 您还可以将后端系统(如数据库或应用程序服务器) 安置在internet访问的私有子网中, 您可以使用安全组和网络访问控制列表等多种安全层吗帮助对各个子网中amazon ec2实例的访问进行控制
 -->

- 通过Vlan技术将物理网络进行一个分配 分割开来之后就变成了虚拟网络在云中它就是一个独立的网络 但实际上你的数据 和 别人在虚拟机上使用的数据 很可能都是跑在一条光纤上面的

- 那数据跑在一条光纤上面会不会有什么样的问题? 安全性的问题
- 如果我们跑在车道上都是明文传输的话, 如果别人对你发起了监听就有可能会出现数据泄露的问题

> 虚拟网络上解决数据安全问题
- 1. 加密文件
- 2. vpn
<!-- 
  vpn等于是我还在这条公路上, 但我是把这条车道修成了隧道 将车道完整的遮罩起来 别人都看不见

  vpn好处就是 加密的特别的好 坏处就是负载会大一些

  要看看vpn的原理
 -->

- 3. 最好的方案就是 先建立vpn然后再对数据进行加密 因为还要防止内部数据被窥探 有内鬼 终止交易

- 这也是 我们上云之后需要考虑的重要问题
<!-- 
  安全在过去的传统的数据中心里面来说 相对于没有那么的重视 你自己的数据中心在内部管理 网络一断就切掉了, 但是现在来说是在虚拟网络中运行的时候会有泄密的问题

  所以我们之后讲的存储和虚拟机这块都会有这样的一个选择让它自动去加密 云上面的所有服务都会考虑加密的事情
 -->


> internet 网关
<!-- 
  PPT资料:
  internet网关是一种横向扩展, 冗余且高度可用的vpc组件, 支持在vpc和internet之间进行通信

  internet网关有两个用途, 一个是在vpc路由表中为internet可路由流量提供目标, 另一个是为已经分配了共有ipv4地址的实例执行网络地址转换(NAT)

  internet网关支持ipV4和ipv6流量, 它不会对您的网络流量造成可用性风险或带宽限制, 在您的账户中拥有internet网关并不需要缴纳额外的费用
 -->

- 在虚拟网络中 vpc可以理解为公司创建的小型的内网 内网可以在一个可用区也可以跨可用区, 同一个区域里面一个大的vpc里面可以包含多个数据中心

- 但是vpc虚拟网络是没有办法跨区的 这只是aws的限制 aws的vpc是在一个区域内创建的 每个区域内有自己的vpc 在默认的状态是可以创建5个vpc 这5个虚拟网络都是可以跨可用区的

- 在创建一个大的网络里面划分小的子网的时候 每个子网只能在一个可用区 但是vpc是可以跨可用区的

- 公司在创建自己的局域网之后 我要公司内部和外面的internet(外网) 网与网相连接 一般情况下在公司里面是使用 路由器(拨号上网) 对外进行链接的

- vpc也是一样的 它也需要一个内部 和 外部 进行链接的一个东西 我们管这个东西叫做 internet网关(internet gateway)

- 一个vpc上有且只能有一个internet gateway 内外全都是通过这个网关对外进行交流
- 外面要是进来也是从这个网关走进来
<!-- 
  小的局域网和外面的互联网之间的联系 也称之为网关 
 -->

- 网关支持ipv4 ipv6我们不用管它是一个托管的 绑定我们的vpc就可以了 只要放上去就可以了
<!-- 
  我们没办法都它进行操作 纯粹就是放在那的一个黑盒子 我们只需要确保想出去的流量指向这个网关就可以了
 -->


> nat网关
- 网络地址转换
- net就相当于电话的总机(猫后面的路由器)
- 猫 只是负责内外相连
- net网关仅支持ipv4 ipv6是没有必要的
<!-- 
  猫 和 路由器的区别 在日常的中 我们的猫和路由器是集成在一起的, 但在aws中猫 和 路由器还是分开的

  net就是路由器
  猫是前面的internet网关
 -->

- nat网关仅支持ipv4(叫做natgateway), net网络不支持ipv6而是改用仅出口internet网关


- 作用:
- 公司外面打电话进来 拨到你公司的总计再转到你的分机号
- 内部电脑访问外部的地址 由于没有公网地址你是没办法直接对外访问的 我借用你的公司总机号再对外去打电话 在外部看来你用的都是公司的总号码


<!-- 
  ipv4地址 私有地址 和 公有地址(这个是有限制的现在已经全部都发完了) 
  为了实现内部网络和外部网络能够直接相连 我们没有办法给内部所有的网络都分配一个ip地址

  比如我们公司对外是一个电话号码  公司内部都是用内部的电话号码短号码进行联系
  如果每一个人都创建一个号码 一是成本很高 二是电信局假如告诉你我没有多余的号码给你了

  怎么办?很简单 我就使用这个net网络地址转换的网关
 -->

- 假如我们使用ipv6的地址 有没有必要用私有的ipv6地址来代表我们内部的地址呢?
<!-- 
  为什么net网关不支持ipv6 因为没有必要因为ipv6的地址足够大了 不需要再通过地址转换哪怕给地球上的没一粒沙子都分配ipv6的地址就这样都绰绰有余

  所以我们的电脑如果没有ipv4地址 但是如果猫是支持ipv6 你的电脑还是可以上网
 -->

> ipv6地址的私有前缀是FC80 或者 FC08



> Nat实例
- 总结:
- nat实例就是一个白盒 我们可以对它手动进行配置 由于它是一个实例 我们要自己负责配置 自己负责更新 因为是我们自己配置的 所以可能会出现太小的情况, 而nat网关是托管的服务 就不会出现太小等状况 来多少会自适应 nat网关来多少流量它都能帮你解决 按小时付费

- nat实例就不一样 因为我们是自己搭配的 我们就需要为实例的大小去付费 有没有人来访问都需要付实例的钱, 但是它方便自定义 我们自己要权衡一下使用哪一样



- 实例是什么? 实例是虚拟机 那nat实例就是nat虚拟机
- nat网关是一个托管的服务 我们没有办法对nat里面的具体转换进行配置 它是一个黑盒
- 我们在设置好一个网关之后它就会帮我们工作, 我们没有办法对它进行配置 比如什么地址过来我们可以转换到后端的某一个虚拟机上 类似这种高级的地址转换它是没有办法做到的

- 它纯粹是实现内部去访问外部使用的 对于外部访问内部的反向代理是没有办法做到的 但是我们现在又想实现一个从外部访问内部的反向代理的话 我们就需要可以自由操纵的一个nat实例 因为它是一个实例(白盒) 我们可以看到实例里面的具体配置的 我们可以手动的配置 首先它是一个nat所以它从内部访问外部是没问题的

- 从外部访问内部 外部的地址想要访问nat后面的拥有私有地址的实例的时候 是没有办法访问到的 我们需要反向代理 需要通过在nat实例上面进行一个反向代理的设置


> 什么是反向代理
- 我们一般的nat是从公司内部往外部去访问 共用一个公网地址去访问外面
- 假如外面想要访问里面的话, 假设公司有总机号码 每个人有内部号码 但是外面的人不知道内部的人所有的号码, 只能先打到总机 然后进行查询 知道你的分支号是多少
- 再由总计转发过去

- 在我们前面的nat网关 没有人去接听 也没有人理你的查询 也就是说没有办法从外部访问到内部

- nat实例有点像公司配了一个人放了一个前台坐在这里 她负责外部的电话 进行查询然后转发
- 这就是nat实例手工的配置我的请求 公司对外的有一个ip地址 然后想要访问公司内部的子网的时候, 我就在后面加上不同的端口, 来进行访问 比如80端口是访问公司总机 通过8080端口就能通过nat实例自动转发到it部门

- 上面就是反向代理, 通过访问一个nat地址 加上一个不同的端口 可以将你的流量转发到不同的后端的私有的地址的实例上面 或者是私有地址的服务上面 这就是反向代理
<!-- 
  反向代理网络上的答案:

  说到反向代理就先讲一下正向代理

  正向代理：
  
  客户端想要访问一个服务器，但是它可能无法直接访问这台服务器，
  这时候这可找一台可以访问目标服务器的另外一台服务器，

  而这台服务器就被当做是代理人的角色 ，称之为代理服务器，
  
  于是客户端把请求发给代理服务器，由代理服务器获得目标服务器的数据并返回给客户端。
  
  客户端是清楚目标服务器的地址的，而目标服务器是不清楚来自客户端，它只知道来自哪个代理服务器，所以正向代理可以屏蔽或隐藏客户端的信息。

  

  反向代理：
  
  从上面的正向代理，你会大概知道代理服务器是为客户端作代理人，它是站在客户端这边的。
  
  其实反向代理就是代理服务器为服务器作代理人，站在服务器这边，它就是对外屏蔽了服务器的信息，
  
  常用的场景就是多台服务器分布式部署，像一些大的网站，由于访问人数很多，就需要多台服务器来解决人数多的问题，这时这些服务器就由一个反向代理服务器来代理，
  
  客户端发来请求，先由反向代理服务器，然后按一定的规则分发到明确的服务器，而客户端不知道是哪台服务器。常常用nginx来作反向代理。
 -->

> 反向代理的用处
- 外部对外部访问进行分流, 能够实现分流的工具负载均衡器


<!--
  PPT资料:

  通过使用您vpc中公有子网内的网络地址转换nat实例, 可让私有子网汇总的实例发起到internet或其它aws服务的出战 ipv4流量, 但阻止这些实例接收由internet上的用户发起的入站流量

  有关公有子网和私有子网的更多信息, 请参阅子网路由
  ipv6流量不支持nat 而是改用仅出口互联网网关
  您的nat实例配额取决于您在该区域的实例配额
 -->



### DNS
- 将ip地址 和 我们能够能记住的名称进行互相翻译的一个工具 对于aws来讲dns服务是一个非常正常的服务
<!-- 
  比如我们再ec2中去访问google.com 它首先会去找dns服务器去查询一下谷歌.com对应的ip地址是什么, 浏览器是通过ip地址去访问谷歌

  我们的浏览器都是用ip地址进行工作
 -->

- 我们可以使用aws内部自带的dns服务器 也可以使用自己的dns服务器
<!-- 
  我们现在使用的电脑的dns服务器是哪一个?

  路由器可以作为我们第一层的dns服务器

  我的电脑访问的任何东西都是转发到路由器, 然后我们路由器再将查询的地址转发到别的dns服务器 然后对应的dns服务器再进行解析

  假如我运营商的dns服务器比较慢 那么我们上网的速度就会很慢 所以我们可以直接把dns服务器修改为8.8.8.8 谷歌的服务器 谷歌的资源很多 所以查询的速度就会很快

  百度的dns服务器 4.4.4.4
 -->



### vpc对等
- vpc对象就是拉网线 前提条件是确保两端的ip地址段不能重复 不然就没办法创建
- vpc的对象互联是不能传递的
<!-- 
  A公司: 
  192.168.0.0 -24

  B公司就不能是 192.168.0.0 -24 它可以用什么地址?
  B公司可以是 192.168.1.0 -24
 -->

<!-- 
  不能传递的解释
  就是说 a和 b 建立连接, a 和 c 建立连接 但是 b 和 c 是不能通过a去互相连接的
  也就是说 b 和 c 也要创建对等互联

  说白了就是要两两相连 相连的vpc才能建立连接

  当我们的量很少的时候是没有任何问题的 (4个vpc我们创建多少个对等2^n-1)
  当我们的公司在几十个国家都有分部 每一个国家都有自己的vpc 让它们之间进行对等互联的话 这得创建好多个对等互联

  aws为了解决这个推出了一个叫做传输网关 所有的vpc都链接到这个中心点 让它做中央的交换机 就是大家都连到一个地方通过它来进行调度
 -->

- 字面意思 两个vpc之间的链接 比如两家公司都有自己的vpc都有自己的局域网 两个公司之间想要通信应该怎么做呢? 
<!-- 
  公司和公司之间直接拉网线 肯定是最好的方法 vpc也可以直接拉网线
  但是两边的ip地址段不能是一样的, 比如很多人家都有短号码 但是短号码不能都一样

  比如a公司有12345 b公司有12345 a b公司一连 外面打电话 12345 是找谁呢?

  拉了网线可能还是不通为什么
 -->

- 如果使用vpn的话就意味着两端都需要有自己的防火墙 路由器来进行一个设置 所有都是从公网上走 这就存在一个安全的问题(我们的数据都是在公网上跑的)

- 这种拉网线的模式不需要额外的配置 他们的网线是从亚马孙的内网去走的不是从公网上走的

<!-- 
  PPT资料:
  vpc对等链接是两个vpc之间的网络链接, 您可通过此链接不公开的在这两个vpc之间路由流量, 这两个vpc中的实例可以彼此通信, 就像他们在同一网络中一样, 您可以在自己的vpc之间, 自己的vpc于另一个aws账户中的vpc或与其他aws区域中的vpc之间创建vpc对等链接

  aws使用vpc的现有基础设施来创建vpc对等链接, 该链接既非网关也非awssite-to-site vpn链接, 且不依赖某个单独的物理硬件, 没有单点通信故障也没有带宽瓶颈
 -->


> 路由表
- 路由表中包含一组被称为路由的规则, 用于确定来自您的子网或网关的网络流量的导向何处
- 类似gps
- 我们再默认状态下vpc会给我们配置一个系统 默认的路由表 它里面只有1条规矩 所有内部地址的访问都会发送到内部的网络 内部查询

- 如果添加了internet网关 就会发送到网关

- 相当于一个十字路口 路口中间有一个向导 你问它如果要去日本怎么走 它会告诉你去日本走左边 去中国走右边 


> 弹性ip地址
- 公有的ipv4的地址是有限的 假如我短期的需要一些公共的ipv4的地址 我可以向aws去申请一些短期使用的ipv4地址它可以给实例或其它的服务进行绑定 让你有一个固定ipv4地址 这个弹性的ip地址不用放在那是需要收费的 申请好了马上就用就不收费

- 一般对外提供服务的服务器如果有必要的话一般都会绑定一个弹性ip地址 让它对外提供服务
<!-- 
  ppt资料:
  弹性ip地址是专门用于进行动态云计算的静态, 共有ipv4地址, 您可以将弹性ip地址与您账户中的任意vpc中的任何势力或网络接口相关联, 借助弹性ip地址, 您可以循序的降低至重新映射到vpc中的另一个实例 从而屏蔽实例故障
 -->


> 安全组
- 这个就相当于我们设置的门卫 控制流量 谁可以进来 谁可以出去 由安全组进行配置
- 安全组放在实例的虚拟机里规定什么样的流量可以进来 什么样的流量可以出去
- 也就是说每一个ec2都会配一个安全组(创建实例的时候有个选项就是配置安全组 规定哪一个端口是开放的)

- 它相当于套在虚拟机外面的一个门卫 其实实例的本身可以在操作系统里面再进行设置一个网络防火墙什么的, 但是现在是相当于在外面套一个门卫保证你的安全

<!-- 
  PPT资料:

  安全组 充当实例的虚拟防火墙以控制入站 和 出战的流量, 当您在vpc中启动实例时, 您可以为该实例最多分配5个安全组, 安全组在实例级别运行, 而不是子网级别, 因此在您的vpc的子网中每个实例都归属不同的安全组集合
 -->


> 网络acl
- 类似网络安全组的概念 它是放在子网的级别 放在更外面一层 放在网络这个级别 它可以控制所有子网下面的所有服务 包含ec2 包含其他的服务 只要是在这个子网里面的 就是由它控制的


> acl 和 安全组的区别
- 网络安全组默认是全部关闭的 只能一个一个去打开 打开需要的端口
- 在我们创建虚拟机的时候帮我们配置了网络安全组 我们要选择打开我们的3389号 或者是 22号端口 相当于在我们的虚拟机上面建了一道围墙 我们要开那个地方就在哪个地方开个洞

- acl不一样 它是默认全部允许, 门洞大开 在哪里需要隔绝的地方, 就那对应的地方建一堵墙
<!-- 
  比如在美国墨西哥边界建到墙
 -->


<!-- 
  PPT资料:

  网络访问控制列表 是vpc的一个可选安全层, 可用作防火墙来控制进出一个或多个子网的流量, 您可以设置网络acl 使其规则与您的安全组相似, 以便为您的vpc添加额外的安全层
  -->


### Amazon Route 53 
- 它是一个dns服务 将ip地址和域名进行解析 它也有注册域名的功能
<!-- 
  PPT资料:

  是一种具有很高可用性和括扩展性的域名系统(dns)web服务 您可以使用route53 以任意组合执行三个主要功能: 域注册, DNS路由和运行状况检查
 -->


### Amazon CloudFront 
- 靠近用户端的缓存服务

- 比如日本公司创建了一个网站 美国想要访问这样一个带图片视频的网站 因为地理位置比较远延时比较长 资源图片 视频太大传输起来会发生卡顿

- 遇到上面的问题 我们可以在美国创建一个镜像

- 快速、高度安全且可编程的内容分发网络 (CDN)
<!-- 
  内容分发网络(CDN)
  比如我现在在日本 我们创建了一台服务器 上面放了一个网站 上面有些视频有写图片对日本本地来说 访问我们网站的速度很快

  有一个客户在美国距离日本6000公里 他要访问我们的网站需要多久 6000公里需要经过多少路由器 多少交换机 信号还要不断的衰减 还有出错的可能性 他等待的时间肯定非常的漫长

  为了解决这个问题, 在靠近美国的地方 我们租用一台存储器(亚马孙提供的服务存储)将客户经常要看的内容提前放一份 放到缓存里面(客户端的缓存) 第一个客户因为缓存中没有相关的资源访问页面等待时间长 体验可能很差 第一个客户发送请求, 响应相关资源的时候 同时往缓存中写了一份 第二个客户它所做的事情的 首先先访问靠近美国这边的缓存 去查看有没有客户要的内容 如果缓存中 那就从缓存中直接调用 不需要再到日本的网络去调用了 这样美国的客户的体验响应速度都得到了极大的提高

  那我怎么知道客户要看什么呢?
  1. 预先判断 常用的文章 图片 视频 我可以手动分发到缓存中 然后通过人工智能学习每张图片的浏览量 将浏览量从上到下的排序 浏览器最低的删掉 把容量空出来 再去检查今天有多少去访问别的内容 将浏览量多的放入到缓存中
 -->

- 内容分发网络就是靠近客户端的一个缓存将静态的资源客户经常会访问的内容放到靠近客户端的缓存当中 
- 比如我们在国外访问淘宝并不会感觉很慢 一方面可能是淘宝在我们本地有服务器, 或者靠近我们的国家地区有缓存


> AWS VPN 
- 将本地网络扩展到云并在任意位置对其进行安全访问
<!-- 
  vpn 我们翻墙使用到的工具 都是通过vpn进行翻墙 vpn类似vlan
  vlan是把网络通道人为的进行划分 放置类似虚拟的挡板在这, 防止走到另外一条道上
  vpn将我们走的道直接拿管子包起来外面人压根就看不见里面有东西, 它就像一个黑管
  外面人看不见里面传输的是什么内容 vpn就是将我们的传输胶囊化 给包起来

  vpn当初最主要的目的是为了安全的防护 不让别人偷窥我们传输的数据 现在被人利用来进行翻墙 翻墙本身并不一定需要vpn 但是vpn能够保证用户翻墙的时候 信息的安全
 -->



### Elastic Load Balancing 
- 当我们在面对一个很大的数据访问量的时候 服务器的承载能力是有限的, 我们可以将这个巨型服务器打算了形成很多的小型服务器 在这些小型的服务器的前面 我们加上一个负载均衡器 它是将这些小型的服务器作为一个整体去处理 当前端收到流量的时候 通过哈希分配的方式分配到后面(平均分配 根据后端的承载能力 比如后面有10个服务器 1号服务器已经占了90%了 一般是从后端服务器池里面选择负载最小的那个去进行负载 它就相当于前端的前台)
<!-- 
  PPT资料:

  Elastic load Balancing 在多个目标(如EC2实例, 容器, IP地址和Lambda函数)之间自动分配传入的应用程序流量, 它可以在单个可用区处理不断变化的应用程序流量负载, 也可以跨多个可用区处理此类负载

  Elastic Load Balancing提供三种负载均衡器, 他们均能实现高可用性, 自动扩展和可靠的安全性 因此能让您的应用程序获得容错能力

  Application Load Balancer
  网络负载均衡器
  Classic Load Balancer
 -->

### OSI七层网络模型
<!-- 
- 七层模型也叫作OSI参考模型是国际标准化组织(ISO)制定的一个用于计算机或通信系统间互联的标准体系, 一般称为OSI参考模型或七层模型
- 说白了就是两台计算机之间进行通信的时候(比如数据传输), 经历了哪些工作

    OSI七层网络模型     TCP/IP四层概念模型      对应网络协议

    -------------       ---------------       -------------

    应用层                                      http tftp ftp nfs wais

    表示层              应用层                  gopher snmp riogin telnet

    会话层                                      smtp dns

    -------------       ---------------       -------------

    传输层              传输层                  tcp udp

    -------------       ---------------       -------------

    网络层              网络层                  ip icmp arp rarp akp uucp

    -------------       ---------------       -------------

    数据链路层          数据链路层              fddi ethemet arpanet pdn

    物理层                                      ieee 802 1a

    -------------       ---------------       -------------

 -->

- 负载均衡器分为几种类型
- OSI七层是将网络传输分成7层 比如我们发条微信都会过下这7层 一条数据的传输都是一个加包和解包的过程
<!-- 
  就好比每经过一层就套一层娃, 一共套7层, 发送到另外一台电脑后也需要解7层 
 -->

- 负载均衡器是在解包第4层的时候开始进行分配 和 第7层开始进行分配
<!-- 
  还要看TCP UDP

  TCP是我发出去确保你能收到 
  UDP是发出去不管的


  第4层是:
  比如我收到了一封信 我拆开了包装里面还有一层信封 信封上已经写明了这个信是谁发过来的 发到哪个部门的 要求对方是干什么的 这个就是第4层 但是信件还没有完全拆开


  第7层负载均衡器
  - 这个是指 我们将数据包已经解压到最后了 一发过来的信我们已经全部拆开 我已经能看到你的信件正文了 我看完之后再决定发给谁 这就是第7层 

  这层的协议也就是https http访问网站的协议 端口是80 443

  到这一层我们的信件已经完全展开了 就意味着我们可以根据你的消息进行更高级的过滤的 因为我已经能看到里面的内容了 比如第4层负载均衡器收到的是一个信封 然后我把信封交给它的主人 这事就完了 至于信封里面是什么东西我就不管了

  到了第7层的负载均衡器已经把信件拆开并且看了一遍 它再决定这封信应该不应该发给它的主人

  所以到了第7层我们就可以加一个防火墙 第4层是没办法安装防火墙的 因为看不出来里面有什么

  网络应用程序防火墙只能工作在第7层 是因为只能在解包完成之后 我们才知道里面有什么 我们才能决定要不要过滤
 -->



- 1. Application Load Balancer
- 第7层的负载均衡器

- 2. 网络负载均衡器
- 第4层的负载均衡器

- 3. Classic Load Balancer
- 最老的一种 负载均衡器 它称之为传统负载均衡器(aws中最早出现的负载均衡器)
- 它的作用就是将前端的流量转发到指定的EC2上去 他没有其他的功能 它相当于一个单一的dns地址 后端转发是给一个地址池 手动添加后面要负载均衡的服务器 就是添加很多的ec2 它可以对所有的协议进行负载均衡


- 那么在工作中 我们是应该使用应用程序负载均衡器还是网络负载均衡器呢 ? 两者的优缺点又是什么呢?
- 第4层非常的快, 解包之后就直接分配了 速度会快一些, 但是没有安全性方面的过滤 所有的安全等于都交给后方的服务器去做了

- 如果是应用程序负载均衡器的话 绝对信件的内容对与不对 是在应用程序负载均衡器本身 大管家已经帮你决定了 这个信件是否违规 比如公司内部有标准 我们就可以让应用程序负载均衡器过滤 确认内容是否违规 不违规我们转发 违规我们就过滤掉 但是因为处理的逻辑比较多, 所以整体的速度就低一些


- 负载均衡器 可以 对外 和 对内 使用
- 在工作中我们对外的服务使用的是  大部分对外都是通过网页的形式展示的 所以我们使用 第7层的负载均衡器 比较安全(有的公司如果只提供ftp传输的话 很可能会用第4层 场景很少)

- 对于公司内部的话 我们没有安全上的要求 更多的是速度的要求 我们在内部只需要使用网络负载均衡器就可以了


### 证书管理 AWS Certificate Manager
- 证书是什么东西? 证书是包含密钥的东西
- 密码: 这个就是我们平时输入的密码


- 密钥: 就是之前间谍使用的密码本
- 目的: 你监听到的消息是你看不懂的
<!-- 
  明文传输:  a 发送 '你好' 给b      假如有监听器的话 别人就会直接获取消息

  为了解决上面安全的问题, 我们可以将内容进行加密
  假如a 和 b 使用的是同一个密码本 进行加密 和 解密的话 叫做 对称性加密
  将明文加密成别人看不懂的密文 假如监听者没有我们的密钥是没办法对密文进行翻译的
  
  - 对称性加密
  - 双方使用的是同一个密码本(同一个密钥)
  - 好处: 由于双方使用的是同一个密钥 翻译的速度比较快
  - 缺点: 双方有一方丢失了密钥 通讯链就断掉了


  为了改掉丢了密码本全部人都要暴露的这种问题 我们改为非对称型加密

  - 非对称型加密
  - 我拥有一个密码本 你拥有另外一个密码本 我通过我的密码本翻译的东西只有通过你的密码本才能解密 我自己都没有办法解密(加密之后没有办法解密的) 这就是非对称性加密

  - 非对成型加密的密钥一般分为 公有的密钥和私有的密钥
  - 公有密钥是每一个人都可以发的
  - 私有密钥只有自己才能拥有的 

  - 公有密钥和私有密钥是一一配对的 一把公钥配一把私钥
  - 好处: 丢了一把钥匙不至于将整个数据链全部丢失 最重要的是保留私钥
 -->


- 证书:
- 验证身份的
- 就是证明你是你 或者是 他是他 是用来验证你的身份是否是你自己
- 有两种验证方式
- 1. 私有证书(不被大家公认的整数称之为私有证书) 非公认的颁发机构发的 私有证书是不被信任的
- 2. 公有证书(还有就是我到公证处和派出所这个是大家公认的)
<!-- 
  公有证书一般都是要付费的 是要维护你的证书

  证书的用法:
  我们去访问一个地方的时候 我们去访问的地方去要它的密钥 跟它传输之间是要加密的
  但是 我要确保你发给我的密钥是你发给我的 怎么证明你是你呢?

  我拿着你的证书 到第三方的机构 去验证一下 你是你 公证处告诉我对 这样你发给我的密钥我就认为是可信的 跟你之间的通信是安全的 这种叫做公有证书


  私有证书:
  证明你是你的证书是你自己开的 我相信不相信你呢?


  我们在反问网站的时候 有的时候提示不安全 原因就是
  1. 这个网站没有证书 它没办法证明它是它 所以它给你发的密钥 你不能保证它的安全
  http 80 端口 你跟这个网站之间的通信是明 文传输 是没有密钥去加密的

  为了安全我们使用了https 也就是说我跟网站之间先等网站给我发一个公钥 然后网站那边留着一个私钥 我们之间的通信是一个加密的通信 但是 你发给我的这把钥匙怎么证明是这个网站发给我的 

  所以我们拿着证书去验证 但为什么还是提示证书不安全 因为这个证书的颁发者是它自己发给自己的

  即使你跟这个网站的通信是加密的(它的证书里面是包含密钥的 一般是非对称型加密) 但是它没有办法证明这个公钥是它发给你的


  如果我们是访问一些 比如谷歌
  它的前面就会提示连接安全 因为它的证书是有效的 它的证书 不是自己发给自己 而是另外一个全球公认的机构 
  在访问谷歌的时候, 网站会告诉我它的证书 我们拿着这个证书 去到它的颁发者那里验证一下是不是它 有公认证书的说明 我们访问的谷歌网站肯定是谷歌网站
 -->

- 证书没有办法被盗取 证书上有包含网站的域名 和 加密算法 并且还包含了公证处的联系方式
- 因为我们会拿到网站的证书去公证处验证, 即使你偷了证书放到了自己的网站上 公证处不认你 也会通不过验证

- 证书的办法机构
- aws

- 我们可以创建一个整数颁发的工具 颁发自己的证书 一般来说私有证书是公司内部使用 不会放对外 比如公司内部传输消息也不希望明文传输 那我就需要通过证书 在证明的同时提供公钥去加密
<!-- 
  公钥是可以发出来的 私钥是网站放留着解密
 -->

- 我们在访问一个网站的时候 会先去访问这个网站的证书 拿到证书后的第一件事就是验证这个证书的真伪 然后得到确认后 我们再使用证书上的公钥 去传输信息
<!-- 
  我们在传输消息之前肯定是验证证书的证明它是它
 -->



### Amazon Relational Database Service (RDS)
<!--  
  rds让您能够在云中轻松设置, 操作和扩展关系数据库, 它在自动执行耗时的管理任务(如硬件预置, 数据库设置, 修补 和 备份)的同时, 可提供经济适用的可调容量, 这使您能够腾出时间专注于应用程序, 为他们提供所需的快速性能, 高可用性, 安全性 和兼容性

  提供了六种常用的数据库引擎供您选择, 包括 Aurora PostgreSQL MariaDB Oracle Database 和 SQL Server

  您可以使用AWS Datebase Migration Service 轻松将您现有的数据库迁移或复制到Amazon RDS
 -->

- AWS为我们提供了 关系型数据库的服务
<!-- 
  关系型数据的概念

  我们整个表格要先定义好 字段 或者是框架 然后再往里面放入数据 我们有很多预先定义的不同的表格 表格和表格之间是通过一些关键词进行链接 

  比如两个表格都是以学号作为主序列那么这两张表格就可以合并成一个表格(视图) 方便我们进行检索

  关系型数据库对应的另一面叫做非关系型数据库 关系型数据库的列是预先定义好的 一般来说是不会做任何修改的, 如果对于框架来修改的话 会修改整个的表格 比较麻烦

  非关系型数据库 它对架构的定义是很松散的 我们可以随时进行修改 对于行里面的内容来说 不要求列里面要对应有数据

  关系型数据库来说一定定义好了一列 那么这列里面就要有相应的数据 哪怕是一个空值也要必须有 关系型数据库是一种比较严格切规范的数据库模型 是一个完整的列表


  关系型数据库非常适合什么场景?
  关系型数据库是结构非常严格已经规定死了的数据存储模式 比如像银行 它对数据库要求的就非常的严格 非常的完备 一般情况下除非重大的事故 是不会做任何的更改

  想如今的互联网模式的话 我们可以输入任何的信息 这种情况就非常的适合用非关系型数据库 因为它很难去定义整个表格的数据 或者说没有办法定义 所以我们的内容肯定是经常要被修改的 所以适合菲关系数据库

  比如我今天跟大家聊天 我定义好了名字 发言 发言的话肯定不是一个简单的数据 它是一个单独的文件格式 是一个json的格式

  但是对于关系型数据库来说 我定义好了一个名字 那么我去查询的时候一定可以在响应的地方查到响应的数据 而不会去做额外的工作
 -->

- 亚马孙给我们提供了5中数据库, 它的兼容模式是这样的, 它的后台是亚马孙给我们创建了一个虚拟机或者说是多个实例 来帮助我们做一些底层的工作 我们所需要做的就是 对这些实例上面的软件进行使用

- 这种模式是哪一种的虚拟化的模式呢? saas模式 硬件 软件 都帮我们配置好了 我们所做的就是使用这个软件就可以了 所以是saas服务

> aurora 是amazon自家的数据库
- 是魔改的mysql 它不是一个全新的数据库 它是集成mysql和postgreSQL的优点的一个数据库 aurora并不是一个单独的服务而是放在redis里面


> Amazon RDS 多可用区的部署
- RDS是一个托管服务 它可以利用到Amazon多可用区优点 可是实现多可用区的部署 我们可以除了主数据库之外 还可以创建其它的副本

- 副本分为两种, 主要作用就是在我的主服务器发生问题的时候 我们的副本可以通过人为的提升, 将它提升为一个主服务器
- 1. 待机副本
- 2. 只读副本

- 一般我们在正常的区域里面都是2-3个可用区 可以在当前的可用区里面创建一个只读副本 也可以创建多个

- Mysql也分为两种 一种是读写, 一种是只读
<!-- 
  mysql在创建的时候能创建一个副本 如果数据库崩溃了 我们还可以利用到副本

  如果建立一个数据库出现问题是怎么处理的?
  Mysql也分为两种类型 一种是只读 一种主数据库 主数据库可以进行读写 数据库大部分的内容都是从中读取那我们又要负责读 又要负责写 那么我们的i/o就会出现一些问题 我们就要取舍i/o到底是要用来读还是写

  一般来说我们创建数据库都是这样的 我们会创建一个主数据库 再创建一到多个只读数据库 他们之间的关系是 非同步的模式

  主数据进行更新之后 它会慢慢的更新到只读数据库里 只读数据库顾名思义 就是 对外提供读取的

  这样讲主数据库主要承担的功能 从可读可写 慢慢过渡到 专门用来写 读取的话会放到只读副本上面 

  当我们的主数据出现问题的时候 我们可以手动的提升其中一个的只读副本(用户最新数据的) 来作为一个主数据库 是这种提高高可用性的模式
 -->


- RDS的多可用区部署的待机副本(待机数据库)
- 我对你这个数据库创建一台完整的一模一样的数据库 但是这个数据库创建好是不可见的隐藏的状态 当我们的主数据出现问题的时候 系统会自动切换到待机数据库上面去 这种叫待机模式
<!-- 
  待机的数据库不管用不用我们要付钱
 -->

- RDS的多可用区部署的只读副本(只读数据库)
- 一个主数据库 外加 一到多个只读副本, 只读副本和主数据库是非同步 也就是说主数据库里面的数据更新会立马发送到只读副本中 它会按照它的等待时间(5-15分钟)同步一次 将新的数据同步到只读副本中 

- 所有其他的用户 对数据库进行数据读取的时候 都会优先发送到只读副本 主数据库是用来写入


- 那我们是怎么判断使用哪一个数据库呢(一个主四个副选择哪个?)
- 我们是使用负载均衡器 它的对外接口就是两个一个读一个写 写的接口指向了主数据库的, 读的接口指向了负载均衡器 由它指向后端的服务器

- 我们在创建RDS的时候对外读写都是一个接口
- 对外提供的接口是一个什么样的格式? ip地址还是dns
- 一定是dns 因为后端的数据库可能随时会变 比如提升了 或者 删除掉了 那我的ip地址会随时发生变化 只有dns地址是不会变的

- 待机副本可以给主数据库 和 只读数据库都可以创建
- 我们创建的待机副本 待机副本不工作 没有任何的事 待机副本 和 数据库之间是实时的同步复制, 主数据库发生更新不可见的待机副本也会马上更新(这点和只读副本的更新方式不一样, 只读副本是非同步的更新)


> Amazon Aurora
- Aurora是一种与Mysql和PostgreSql兼容的关系数据库
- 它一个魔改的Mysql和PostgreSql aurora在前两者之上提高了性能 它帮我们预先配置好了主数据库 只读副本(创建aurora的时候都帮我们创建好了)
<!-- 
  比如我要是在日本创建了一个aurora 它就会帮我在日本的可用区至少创建一份可读副本(3个可用区至少有2个) 数据盘在每个可用区自动有两个备份

  也就是说一个主数据库 两个只读副本 6份数据 主要我们创建了一个aurora

  当然不是只能创建两个只读副本 我们支持最多创建15个只读副本(3个可用区里面)
  数据盘在每个可用区最少有两套
 -->

- aurora就是一个预先配置好的mysql 就部署来说它是一个非常自动化的过程
- aurora帮你预配好了这么多的事情, 安全性可调校到最高了 它的代价就是贵 非常的贵



> 非关系型数据库 Amazon DynamoDB
- 非关系型数据库就是说 架构没有办法满足我们的所有要求 也就是说我们没有办法在创建数据库的时候把所有的请款古兜考虑到 尽善尽美(初始化定义的时候就将表格定义的非常完美 把所有的情况都包含在内), 那怎么办?

- 我们就使用这种非关系型数据库 它的结构是不固定的不稳定的 它的架构是可以随时的进行更改的 这种的好处就是尽可能的满足你所有的需求 还可以储存几乎所有的数据类型 和 所有的情况 哪怕当前的表格 我没有针对当前的情况设置对应的列 但是由于我是非关系型的数据库 所以我的结构可以马上进行更改 添加响应的列 或者说我们文档之类的其它方式进行描述 而不是将数据直接存到表格里面来

- 非关系型数据库也是支持关系型数据库的表格, 只是关系型数据库的表格是不能简单的进行修改 
- 那么非关系型的数据库定义好的表格不改就是了 还是可以用非关系型的数据库当关系型的数据库进行处理 


- 非关系型数据库对处理的优化 和 关系型数据库是不一样的
<!-- 
  ppt文档中说 dynamoDB每天可处理超过10亿请求, 并可支持每秒超2000万个请求的峰值
 -->

- 我们思考一下 对于关系型数据库 和 非关系型数据库 哪个处理数据 请求比较快
- 没有说它俩谁更快一些
- 非关系型数据库并不是只有kv这一种模式 还有文档的模式 还有图形处理的模式
<!-- 
  假设双方都只有一个表格 那查询起来的话一定是关系型数据库更快 但是关系型数据库往往不只有一个表格

  我们可能通过一个查询去链接一个表格 再去链接另外一个表格 当它牵扯的表格越来越多的时候速度就会越来越慢

  这就是很多新的互联网公司将它们的数据库 慢慢的从关系型 迁到非关系型

  就处理数据的速度而言就关系型更快 但是由于它的结构复杂 导致它的能效比非常的底下 就现在的复杂的场景来说

  非关系型数据库 由于它的非常简便 所有表格都是一个索引 一个表格几乎可以放下所有的数据 即便整体效率不如关系型数据库

  关系型数据库比如说 只要确定好了数据 确定好了好查询的内容 你的返回来的值就一定再那个位置 可以很方便的去定位 导致数据块

  对于非关系型数据库来说 由于你是键值对的 或者说是文档的模式 键值对的方式比较快一些 但是文档来说 比如前面是学号 我后面对应的值 不是一个具体的数字 而是一个json的文件

  对于数据越大 越复杂 非关系型的数据库就越快 结构越简单 关系型就越快
 -->

- 如果我们的数据是kvkv的 关系型会快一些 但是数据不可能只有一个表, 所以非关系型数据库, DynamoDB是非常适合现状的

- 网游的数据库 国内很多用的是MongDB 它非常适合我们互联网企业 用户很多

- DynamoDB也可以作为缓存来使用
- 类似 移动 web 游戏 广告技术, 物联网 以及其他需要任何规模的低延迟数据访问的应用程序 都会选择非关系型数据库 因为这些企业的数据可能是灵活多变的结构


> Amazon ElasticCache
- 缓存
- 我们在前端的服务器处理完数据的时候会不断的对后端的数据库发起请求去查询相应的数据或者说写入相应的数据
- 但是由于数据库里面的数据是放在硬盘上的SSD HHD我们的处理数据会遇到瓶颈 就算是6万4千次的SSD 我们假设前端有100台的数据服务器 同时对后端的数据进行查询 天猫11 每秒有上亿的请求向后端进行查询 那我们的数据库就会承受上亿次的查询 那我的硬盘的承载能力是64000次 那该怎么办? 我该怎么提高数据库的性能

- 将最近用的内容放到缓存里面去
- 缓存存放数据的地方不再是硬盘而是内存 我们创建一个缓存其实它也是一台虚拟机 它的特色就是它的处理器不需要很大 硬盘也不需要很大 它唯一需要大的就是它的内存 我们可以设置一个双核的cpu 加上1280G的内存 这是一个标准的缓存服务器

- 由于内存的速度会比硬盘的速度快上上千倍 所有的数据第一次查询的时候会优先的到缓存里面去去检查一下看看之前有没有人查询过 有没有对应的结果 如果没有我就去硬盘里面读取结果 第一次会比较慢 第一个用户接到数据后 还会在缓存中放一份存档 第二个用户再次请求该数据的时候就会去缓存里面查找 看看有没有对应的结果 有就会从缓存汇总直接给用户 用于内存的速度会比硬盘的速度快1000倍 这样做极大的缓解了对数据库的压力 这是借助了速度差

- 那么问题来了 缓存也不是无限大的 因为大家不会只查询同一个页面 比如双11 那么缓存中就会积攒上千万的页面 最后就会存满

- 当缓存存满的时候 怎么处理呢 它借用了冒泡算法 我的数据放了一份在缓存里面之后 数据本身就会被加上一个标签 这个标签上会有对应的数字 有多少人读取了这个缓存的数据 每隔一段时间就会根据这个数据进行从高到低的排序 排在最后的进行删除 更新缓存 将访问量低的从缓存中删掉空出新的位置来

- amazon还给我们提供了另外一个服务 是队列服务

> 队列服务
- 队列能确保我们的数据从专用的通道进去之后一定能达到对面的目标 不会中间发生什么事故 确保数据一定能送到 确保先进先出(这个不是必须的可以启动和不启动 需要额外付钱)
<!-- 
  比如我们在公路上跑车, 有的时候会出现插队 车坏了的情况, 车况会比较乱一些 
  我现在设置这样一个机制 这个机制叫做队列

  它可以理解为一个通道 我们给它一个特殊的限制, 比如vip可以走这个通道 所有数据标记上vip的从这个通道走 这个通道的好处 1是不堵车

  这个通道我们可以设置先进先出 不允许有人插队 vip的通道就是队列 就是收费的地下通道
 -->

- 我们可以指定进口(比如一个dns地址), 我们在里面确定是先进先出还是随机出 取决于我们怎样设计规则
- 我们可以指定出口(比如队列的出口是数据库的进口) 队列是自己进行设置的 是需要开发人员进行单独的设置 它可以创建一个队列, 设置好进口出口

- 队列可以按照我们的需求设置成你想要的长度大小 比如规定里面只能走10辆车或者走100辆车 取决于你付多少钱

- 比如前面上100台服务器要发送请求到后端的数据库 每秒几千条请求发送给数据库 有的时候会发生网络阻塞 有的请求会发生意外导致请求丢失 或者因为网络堵塞 数据在网络传输里面都有一个叫做生存时间的概念 当它们的生存时间达到终点的时候 即便这个请求没有发送到目的地 它也会自己消失掉

- 那我们选择平邮还是挂号信(我们选择挂号信) 只要把信发送到对应的通道里面 就能确保这个信一定能达到对面 至少确保有3次投递

- 由于它能确保你的信息不会丢失 在3次投递期间它会一直存在在这个通道(队列), 那这个队列就会慢慢的加长

- 当队列达到承载极限的时候 那么其他的数据就没有办法进来了


- 讲回缓存
- 缓存就是我在中间修了一个停车场 别人经常查询的东西我就往里面放放 靠近后端的缓存叫做ElasticCache 弹性缓存

- 靠近前端用户的缓存叫 cloudfront 云的前端 

- amazon对于缓存的软件有两种
- 1. memcached 它是一个非常简单的缓存的工具 在用户请求的时候放一份到它的里面在它这里进行存储 它对数据不能进行任何的处理和计算 就是一个临时存放点 它的速度比较快 如果缓存出现了问题 那么放在里面的内容也就丢失了

- 2. redis 适用于redis的amazon elasticache
- 有的时候我希望缓存也具有高可用性 memcached不好当虚拟机出故障的时候数据会丢失
<!-- 
  天猫在双11的时候 我热门商品的排行 天猫双11当天的销售量 这些都是实时的数据 这些实时的数据是怎么来的呢? 因为这些数字不停的往上跳 是怎么实时计算的

  它可以使用redis这个技术 它也是一种缓存技术 它是一个标准的键值的模式
  它是有一定计算能力的缓存 它可以进行简单的计算, 和对我们的缓存进行备份

  它是一个高可用性缓存 实时可以扩展的一个组 里面是很多缓存的虚拟机 它们之间会进行互相的复制和调用 将一个缓存的工作可以分配到多个缓存上去 分区分片实现协同工作 意味着假如缓存的虚拟机宕机了 因为我们都在和别的缓存同步 我再创建一台新的虚拟机后可以将数据同步到新的虚拟机上 会重新获得原来丢失的内容

  还可以将缓存定期的进行备份 我们可以通过快照在缓存出现问题的时候将它迅速的恢复出来

  这留shiredis的高可用性 和 协同工作性
 -->

- 它拥有简单的计算功能 比如说数字看板 就是上面说的实时排行
- 数字看板和排序都是通过缓存技术实现的实时更新
<!-- 
  比如天猫的销售的看牌和排序 这些数据都是不是从数据库中取出 然后根据取出的数据重新计算 因为事件来不及

  通过redis不需要从数据库中读取数据然后进行写入 和 计算 我直接在缓存里面就进行了计算 将我的数据进行了实时的更新和反馈 

  不需要数据库进行计算 缓存服务器就可以进行计算了
 -->


> 对比下memcached redis
- memcached就是将数据放到里面去 进行简单的分区 它不能进行备份和相互的复制 它也不能计算
- 不是说redis一定比memcached好 看下适用范围

- 如果我希望redis进行复杂的数据计算怎么操作呢? memcached redis也是键值的模式其实他们也是数据库 他们可以跟另外一个数据库切换身份 DynamoDB 它可以作为缓存放在中间

- 当redis不能满足性能的需求 特别是要进行写复杂运算的时候 DynamoDB就能完美的替代它的功能
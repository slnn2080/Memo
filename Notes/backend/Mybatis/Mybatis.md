# MyBatis
它在MVC的整合中担任的是持久层的框架, 它对JDBC再次的进行封装, 实现的功能是连接数据库 操作数据库中的数据

<br>

该框架提供了如下的两个功能
1. sql maps: sql映射  
将我们Java层面的实体类对象 映射为 数据库中的一条记录 或者说 将数据库中的记录查询出来组成Java中的一个实例对象

<br>

2. data access object: DAO层  
进行数据访问, 链接数据库 访问数据库 操作数据库

<br>

### 下载
如果我们要下载 MyBatis Jar 和 文档, 我们是要从Github上下载的

```s
https://github.com/mybatis/mybatis-3
```

**扩展:**  
jar相关, 当我们学习了Maven之后 我们可以从中央仓库和镜像网站中直接下载

<br>

### MyBatis特性:
**1. MyBatis是支持定制化sql, 存储过程 以及 高级映射的优秀的持久层框架**  

**定制化sql:**  
自己写sql

<br>

**高级映射:**   
我们原来学JDBC的时候 手动封装过工具类 当我们查询一条数据的时候, 如果字段名和属性名一致 就会自动将记录转换为相对应的实体

特殊情况, 当字段名和属性名不一致 以及 多对一的映射 或 一对多的映射 这时候我们是没有办法正常的映射的

这里 MyBatis就为我们提供了相对应的解决方案

<br>


**2. MyBatis避免了几乎所有的JDBC代码和手动设置参数以及获取结果集**  
我们之前写过JDBC的代码, 过程都是一样的
1. 注册驱动
2. 获取连接
3. 获取预编译对象
4. 执行sql
5. 处理获取的结果

这个过程既然都是固定了 MyBatis就将大部分的JDBC的代码进行了封装 也就是我们在使用MyBatis的过程中 就不需要手动写JDBC的代码了

<br>

**手动设置参数:**  
一般情况下 sql 几乎很少是写死的, 有些数据我们是需要拼接到sql中的 因为好多参数都是从浏览器传输到服务器中的 我们需要将这些参数手动的拼写到sql语句中  

在JDBC中我们是需要使用 ? 占位符 或 字符串进行拼接 来完成这样的逻辑, MyBatis中也为我们提供了两种方式
- #{}: 字符串拼接
- ${}: 占位符赋值 

<br>

**避免获取结果集:**  
我们在查询的操作中最终会获取一个结果集 我们需要对结果集进行解析 解析之后把结果中的数据 转换为 Java中的一个对象

但是在MyBatis中我们不需要手动获取结果集 也不需要手动的解析结果集 这个过程都是MyBatis帮助我们完成的

<br>

**3. MyBatis可以使用简单的xml或注解用于配置和原始映射, 将接口和Java的POJO映射成数据库中的记录**
MyBatis在实现对数据库的数据进行操作的过程中, 我们有如下的两种方式进行
1. xml方式 <=
2. 注解方式

将POJO映射成数据库中的一条记录, MyBatis不需要我们进行复杂的过程 我们只需要简单的配置就可以完成对数据库中的操作了

<br>

**4. MyBatis是一个半自动的ORM框架**  
将Java中的对象 和 数据库中的记录 创建映射关系 将Java中的一个对象映射成一条数据, 也可以将数据库中的一条记录查询为Java层面的一个对象

<br><br>

## MyBatis和其它持久化层技术的对比

### JDBC
- sql夹杂在Java代码中 耦合度高,  导致硬编码内伤
- 维护不易且实际开发需求中sql有变化 频繁修改的情况多见
- 代码冗长, 开发效率低

<br>

**硬编码的弊端:**  
在JDBC中我们写的sql是直接写在Java代码中的 
- 我们的Java项目以后要打成jar包
- 我们的web工程以后要打成war包

如果我们使用的是硬编码的方式, 将sql语句写死在Java代码中 我们的Java代码需要先编译再执行 然后再打包

如果我们这时候我们要修改一条sql语句, 我们只能改变源代码 然后修改源代码 进而修改sql语句 改完后我们还需要重新进行编译 打包 再执行

这个过程就会变的非常的复杂

<br>

### Hibernate 和 JPA
- 操作简便 开发效率高:   
因为它是一个全自动的持久层的框架 我们在使用Hibernate的时候 只要我们创建好实体类和配置文件 我们会发现表我们都不需要建 sql也不需要写 只要我们调用方法 就能自动的生成sql语句 拿到我们想要的效果

- 程序中的长难复杂sql需要绕过框架

- 内部自动生产的sql 不容易做特殊优化

- 基于全映射的全自动框架 大量字段的pojo 进行部分映射时比较困难

- 反射操作太多 导致数据库性能下降:  
框架中大量的使用反射 因为Hibernate很多操作都是自动完成的 所以都会使用反射 所以性能就会有所下降

<br>

### MyBatis
- 轻量级, 性能出色

- sql和Java编码分开, 功能边界清晰 Java代码专注业务 sql语句专注数据:  
MyBatis中有两种方式写sql 一种是注解 一种是xml, 所以我们的sql是写在xml中的, 是和Java代码分开的 这时我们要维护一个sql语句 我们只需要修改xml文件就可以了

- 开发效果稍逊于Hibernate 但是完全能够接受

<br><br>

## MyBatis下载:
我们这里下载 MyBatis 的文档 和 Jar包, 在Github的readme的部分有如下的3个选项
1. see the docs
2. download latest: 下载最新版本
3. download snapshot: 下载快照版本

我们下载的是 3.5.11

<br><br>

## 搭建MyBatis

### 开发环境
如下是老师的开发环境

- IDE: 2019.2
- maven 3.5.4
- mysql 8
- MyBatis 3.5.7

<br>

### mysql不同版本的注意事项:
**1. 驱动类 driver-class-name**  
**mysql5:**  
使用 jdbc5 驱动 驱动类使用: com.mysql.jdbc.Driver

<br>

**mysql8:**  
使用 jdbc8 驱动 驱动类使用: com.mysql.cj.jdbc.Driver

<br>

**2. 连接地址:**  
**mysql5的url:**  
```
jdbc:mysql://localhost:3306/ssm
```

<br>

**mysql8的url:**  
```
jdbc:mysql://localhost:3306/ssm?serverTimezone=UTC
```

